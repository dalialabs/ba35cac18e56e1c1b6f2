"use strict";(self.webpackChunkmaia_node=self.webpackChunkmaia_node||[]).push([[467],{60467:(e,t,n)=>{n.r(t);n(30050),n(59749),n(81919),n(99474),n(35082),n(40739),n(86544),n(84254);var o=n(70885),s=n(71002),i=n(42982),a=n(15861),r=n(4942),l=n(15671),c=n(43144),d=n(82963),u=n(61120),p=n(79340),h=n(64687),f=n.n(h),v=(n(752),n(60228),n(21694),n(76265),n(78730),n(79307),n(69358),n(38077),n(34338),n(6203),n(50886),n(96869),n(64043),n(278),n(25728),n(73964),n(57267),n(30024),n(12826),n(98742),n(49693),n(47522),n(19649),n(76801),n(43843),n(63975),n(28436),n(2918),n(77049),n(89730),n(36585),n(268),n(65137),n(9873),n(52003),n(34284),n(97195),n(72410),n(42227),n(41517),n(50783));function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,s=function(){};return{s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){r=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(r)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}var k="dalia-apply-token",S="dalia_apply_token_".concat(window.location.href),C={baseUrl:"http://dashboard.dalia.localhost:3000",submitPath:"api/v2/eapply/web",webReapplyPath:"api/v2/eapply/web-reapply-jobs",clientIsApplyEnabledPath:"api/v2/eapply/client-is-apply-enabled",messagesPath:"eapply/web-messages",customCssPath:"",loadingGifPath:"images/apply-loading.gif",useGreyLoader:!1,completeMessage:"You have completed the application questions successfully",blackListMessagesContains:["Reminder","Previous application status was"],customCss:"",css:"",clientId:"",autoStart:!1,postApplySuggestionsDelay:1e3,remScale:null},x=["Enter","NumpadEnter"],q=function(e){function t(){var e,n,o,s;return(0,l.Z)(this,t),n=this,o=t,o=(0,u.Z)(o),e=(0,d.Z)(n,b()?Reflect.construct(o,s||[],(0,u.Z)(n).constructor):o.apply(n,s)),console.log("Loading dalia apply web..."),e.attachShadow({mode:"open"}),e}var h,y,g;return(0,p.Z)(t,e),(0,c.Z)(t,[{key:"attributeChangedCallback",value:function(){this.options=w(w(w({},C),this.dataset),{},{loadingGifPath:"true"===this.dataset.useGreyLoader?"images/apply-loading-grey.gif":C.loadingGifPath})}},{key:"connectedCallback",value:function(){this.attributeChangedCallback(),this.render()}},{key:"getUserToken",value:function(){var e=new URL(window.location.href);if(e.searchParams.has(k))return e.searchParams.get(k);var t=window.localStorage.getItem(S)||this.options.applyToken;return t||null}},{key:"canRender",value:function(){return null!==this.getUserToken()}},{key:"anonymousApply",value:function(e){var t=this;if("SIGNAL_APPLY"===e)return{};var n="dalia_apply_anon_conv_".concat(window.location.href),o=null!=this.options.preFillUserData?JSON.parse(this.options.preFillUserData):null,s=null!=this.options.anonymousApplyQuestions?JSON.parse(this.options.anonymousApplyQuestions):null,i=(null!=s?s:[{label:"What is your First Name?",key:"first_name"},{label:"What is your Last Name?",key:"last_name"},{label:"What is your Email Address?",key:"email"},{label:"What is your Job Title you are interested in?",key:"job_title"},{label:"What is your location?",key:"location"}]).filter(function(e){return!e.skipIfKnown||!o||!o[e.key]}),a=function(){var e=window.localStorage.getItem(n);return e?JSON.parse(e):(window.localStorage.setItem(n,"[]"),[])},l=function(e,n){if("job_title"!==n.key)return n.label;if(!t.jobTitles)return n.label;var o='\n            <label for="job-title-dropdown">'.concat(n.label,'</label>\n            <select\n              id="job-title-dropdown"\n              style="border-radius: 0.6rem; margin-top: 5px; padding: 10px; border-color: #dddddd;">\n              <option disabled selected>Please Select</option>\n              ').concat(t.jobTitles.map(function(e){return'<option value="'.concat(e.value,'">').concat(e.label,"</option>")}).join(""),"\n            </select>\n          "),s=setInterval(function(){var e,n;if((null===(e=a())||void 0===e||null===(n=e.filter)||void 0===n||null===(n=n.call(e,function(e){return"answer"===e.type}))||void 0===n?void 0:n.length)>3){try{t.shadowRoot.querySelector("#job-title-dropdown").remove()}catch(e){}clearInterval(s)}},50),i=null;return t.shadowRoot.addEventListener("change",function(e){"job-title-dropdown"===e.target.id&&(i&&clearTimeout(i),t.enableChatInput(),e.target.disabled=!0,t.shadowRoot.querySelector(".chat-input").value=e.target.value,t.shadowRoot.querySelector(".btn-send").click())}),i=setTimeout(function(){var e=t.shadowRoot.querySelector("#job-title-dropdown");e&&!e.disabled&&t.disableChatInput()},350),o},c=function(e){var t=a();t.push(e),window.localStorage.setItem(n,JSON.stringify(t))};if(e){var d=a().filter(function(e){return"question"===e.type}).pop();if("email"===d.question.key&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return setTimeout(function(){return t.renderMessage('<span style="color: red">Email is not valid</span>',void 0,"started")},300),{};c({question:d.question,text:e,type:"answer"})}var u=a();if(!this.renderedBefore){this.renderedBefore=!0;var p,h=m(u);try{for(h.s();!(p=h.n()).done;){var f=p.value;l(0,f.question),this.renderMessage(f.text,"answer"===f.type,"started")}}catch(e){h.e(e)}finally{h.f()}null!=u&&u.length&&this.minimizeApplyChat()}var v,y=0,g=m(i);try{var b=function(){var e=v.value;if(!u.find(function(t){return"question"===t.type&&t.question.key===e.key})){var n=l(0,e);c({question:e,text:n,type:"question"}),setTimeout(function(){return t.renderMessage(n,void 0,"started")},300)}var o=u.find(function(t){return"answer"===t.type&&t.question.key===e.key});if(o&&y++,!o)return 1};for(g.s();!(v=g.n()).done&&!b(););}catch(e){g.e(e)}finally{g.f()}if(y===i.length){var k=a().filter(function(e){return"answer"===e.type}).reduce(function(e,t){return w(w({},e),{},(0,r.Z)({},t.question.key,t.text))},{});return{user:w(w(w({},null!=o?o:{}),k),{},{job_url:this.options.jobUrl||window.location.href,phone:this.options.phone})}}return{}}},{key:"render",value:(g=(0,a.Z)(f().mark(function e(){var t,o,s,i,a,r,l,c=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canRender()){e.next=14;break}return e.prev=1,e.next=4,window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.clientIsApplyEnabledPath),{method:"POST",headers:{"x-api-token":this.token,"Content-Type":"application/json"},body:JSON.stringify({clientId:this.options.clientId||window.location.href.split("job/")[1].split("_")[0].replace("c","")})}).then(function(e){return e.json()}).catch(function(){return{enabled:!1}});case 4:if(null!=(t=e.sent)&&t.enabled){e.next=7;break}return e.abrupt("return");case 7:this.jobTitles=null==t?void 0:t.jobTitles,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return");case 14:return e.prev=14,e.next=17,n.e(684).then(n.bind(n,68684));case 17:return o=e.sent.default.toString(),this.options.remScale&&"undefined"!==this.options.remScale&&"null"!==this.options.remScale&&(o=o.replace(/(-?\d*\.?\d+)rem\b/g,"$1em")),this.shadowRoot.innerHTML+="<style>".concat(o,"</style><style>").concat(this.options.css,"</style>"),e.next=22,window.fetch("".concat(this.options.baseUrl,"/html/apply-web-hosted-jobs.html"));case 22:return s=e.sent,e.next=25,s.text();case 25:return i=e.sent,a=document.createElement("template"),i=i.replace(' style="display: none;"',""),a.innerHTML=i,this.options.customCss&&""!==this.options.customCss&&(this.shadowRoot.innerHTML+='<link rel="stylesheet" href="'.concat(this.options.customCss,'">')),this.shadowRoot.appendChild(a.content.cloneNode(!0)),this.options.customCssPath&&""!==this.options.customCssPath&&(this.shadowRoot.innerHTML+='<link rel="stylesheet" href="'.concat(this.options.customCssPath,'">')),e.next=34,new Promise(function(e,t){var n=setInterval(function(){var t;c.prepareSelectors(),null!==(t=c.applyButtons)&&void 0!==t&&t.length&&(clearInterval(n),e())},25)});case 34:if(this.prepareSelectors(),this.renderJobTitle(),this.toggleViewModal(),this.sendMessageEvents(),this.updateDocumentRoot(),this.renderLoadingImage(!1),this.handleResize(),v.Z.syncViewportHeightForIOS(this.applyWebContainer),this.canRender()){e.next=44;break}return e.abrupt("return",this.anonymousApply());case 44:return e.next=46,this.loadMessages();case 46:r=this.getMessages(),l=r.some(function(e){return"user"===e.initiator}),!this.options.autoStart&&l&&r.length>0&&this.minimizeApplyChat(),e.next=54;break;case 51:e.prev=51,e.t1=e.catch(14),console.error(e.t1);case 54:case"end":return e.stop()}},e,this,[[1,10],[14,51]])})),function(){return g.apply(this,arguments)})},{key:"handleResize",value:function(){var e=this,t=!1;this.chatInput.addEventListener("focus",function(){t=!0}),this.chatInput.addEventListener("focusout",function(){t=!1});var n=window.visualViewport.height;window.visualViewport.addEventListener("resize",function(){if(e.applyWebContainer.classList.contains("popup-opened"))if(t&&window.visualViewport.height<n){e.applyWebContainer.style.height="".concat(window.visualViewport.height,"px");var o=e.shadowRoot.querySelector(".chat-messages");o&&o.scrollTo(0,o.scrollHeight)}else e.applyWebContainer.removeAttribute("style")})}},{key:"updateDocumentRoot",value:function(){var e=this,t=document.querySelectorAll(".apply-btn");t.length>0&&t.forEach(function(t){t.removeAttribute("href"),t.removeAttribute("target"),t.addEventListener("click",function(){e.maxmizeApplyChat()})})}},{key:"renderMessages",value:function(e){var t=this;if(e.applyApplication&&(e=this.reformatApply3Data(e)),this.removeLoadingIndicator(),"already_applied"===e.appUserStatus)return this.handleSubmissionComplete(e.appUserStatus),this.applyWebContainer.remove();e.messages.forEach(function(n){var o;t.renderMessage(n.options.content,"user"===n.initiator,e.appUserStatus,null===(o=n.options)||void 0===o?void 0:o.isPreformattedHtml)});var n=this.shadowRoot.querySelector(".chat-messages");n&&n.scrollTo(0,n.scrollHeight),setTimeout(function(){return t.checkAndHideResumeUploadForms()},200)}},{key:"isQuestionAnswered",value:function(e){var t=e||{},n=t.answer,o=t.answers;return!(!n&&!o)&&[n].concat((0,i.Z)(o)).some(function(e){return e&&"incoming"===e.type})}},{key:"reformatApply3Data",value:function(e){var t,n,o=this;this.messages=[];var s=new Set;if(null!=e&&null!==(t=e.applyApplication)&&void 0!==t&&null!==(t=t.operations)&&void 0!==t&&null!==(t=t[0])&&void 0!==t&&null!==(t=t.question)&&void 0!==t&&null!==(t=t.parsedText)&&void 0!==t&&t.includes("Required questions end with")&&(this.isIcimsApply=!0),null==e||null===(n=e.applyApplication)||void 0===n||!n.operations||!Array.isArray(e.applyApplication.operations))return e;var i,a=m(e.applyApplication.operations.filter(function(e){var t;return null==e||null===(t=e.question)||void 0===t?void 0:t.selector}));try{var r=function(){var e,t,n,a=i.value,r=!1;if(null!==(e=a.question)&&void 0!==e&&e.parsedText){var l,c,d="resume_upload"===(null===(l=a.question)||void 0===l?void 0:l.selector)||"file"===(null===(c=a.question)||void 0===c?void 0:c.type),u=o.isQuestionAnswered(a);d&&u||(o.messages.push({options:{content:u?a.question.originalText:a.question.parsedText},initiator:"system"}),r=!0)}if(null!==(t=a.answer)&&void 0!==t&&t.originalText){var p,h,f,v,y=a.answer.originalText;Array.isArray(y)&&(y=y.join("")),"string"!=typeof y&&(y=String(y));var g="resume_upload"===(null===(p=a.question)||void 0===p?void 0:p.selector)||"file"===(null===(h=a.question)||void 0===h?void 0:h.type)||y&&(y.includes("storage.googleapis.com")||y.includes("file-upload/resume/")),w=(null===(f=a.question)||void 0===f||null===(f=f.options)||void 0===f||null===(v=f.find)||void 0===v||null===(v=v.call(f,function(e){return e.value===a.answer.parsedText}))||void 0===v?void 0:v.text)||y;if(g&&y){var b=y.trim().split("?")[0];if(s.has(b))w=null;else{var k,S=(null===(k=y.split("/").pop())||void 0===k?void 0:k.split("?")[0])||"Resume.pdf";w=o.formatResumeAnswer(y,S),s.add(b)}}w&&o.messages.push({options:{content:w,isPreformattedHtml:!!g},initiator:"user"})}if((null===(n=a.answers)||void 0===n?void 0:n.length)>0){var C,x=m(a.answers);try{var q=function(){var e=C.value;if(r||"outgoing"!==e.type&&"outgoing_reminder"!==e.type||(o.messages.push({options:{content:e.originalText},initiator:"system"}),r=!0),"outgoing_error"===e.type&&o.messages.push({options:{content:e.originalText},initiator:"system"}),"incoming"===e.type){var t,n,i,l,c,d,u=(null===(t=a.question)||void 0===t||null===(t=t.options)||void 0===t||null===(n=t.find)||void 0===n||null===(n=n.call(t,function(t){var n;return t.value===e.parsedText||t.value===(null===(n=e.parsedText)||void 0===n?void 0:n.value)}))||void 0===n?void 0:n.text)||e.originalText;Array.isArray(u)&&(u=u.join("")),"string"!=typeof u&&(u=String(u));var p="resume_upload"===(null===(i=a.question)||void 0===i?void 0:i.selector)||"file"===(null===(l=a.question)||void 0===l?void 0:l.type)||u&&(u.includes("storage.googleapis.com")||u.includes("file-upload/resume/")),h=(null===(c=a.question)||void 0===c||null===(c=c.options)||void 0===c||null===(d=c.find)||void 0===d||null===(d=d.call(c,function(t){return t.value===e.parsedText}))||void 0===d?void 0:d.text)||u;if(p&&u){var f=u.trim().split("?")[0];if(s.has(f))h=null;else{var v,m=(null===(v=u.split("/").pop())||void 0===v?void 0:v.split("?")[0])||"Resume.pdf";h=o.formatResumeAnswer(u,m),s.add(f)}}h&&o.messages.push({options:{content:h,isPreformattedHtml:!!p},initiator:"user"})}};for(x.s();!(C=x.n()).done;)q()}catch(e){x.e(e)}finally{x.f()}}};for(a.s();!(i=a.n()).done;)r()}catch(e){a.e(e)}finally{a.f()}return{messages:this.messages,appUserStatus:e.applyApplication.status}}},{key:"getMessages",value:function(){return this.messages||[]}},{key:"loadMessages",value:(y=(0,a.Z)(f().mark(function e(){var t,n,o,s;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.messagesPath),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken()})});case 2:return n=e.sent,e.next=5,n.json();case 5:if(o=e.sent,this.removeLoadingIndicator(),this.token=o.token,s=(null==o?void 0:o.appUserStatus)||(null==o||null===(t=o.applyApplication)||void 0===t?void 0:t.status),o.postApplySuggestions&&(this.options.postApplySuggestions=o.postApplySuggestions),!this.isUserApplied(s)){e.next=14;break}this.handleSubmissionComplete(s),e.next=21;break;case 14:if("submitted"!==s){e.next=18;break}this.showRelevantJobs(),e.next=21;break;case 18:return this.renderMessages(o),e.next=21,this.checkForPendingFormReview();case 21:case"end":return e.stop()}},e,this)})),function(){return y.apply(this,arguments)})},{key:"checkForPendingFormReview",value:(h=(0,a.Z)(f().mark(function e(){var t,n,o=this;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",headers:{"x-api-token":this.token,"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken(),answer:"",userClickedApplyWebButton:!0})});case 3:return t=e.sent,e.next=6,t.json();case 6:if("FORM_REVIEW"!==(n=e.sent).type){e.next=11;break}return this.disableChatInput(),this.renderFormReview(n.formsData),e.abrupt("return",!0);case 11:if("FORM_MODAL"!==n.type){e.next=16;break}return this.handleFormModal(n),this.removeLoadingIndicator(100),n.completed&&setTimeout(function(){o.renderLoadingImage(),o.sendMessage("")},300),e.abrupt("return",!0);case 16:return e.abrupt("return",!1);case 19:return e.prev=19,e.t0=e.catch(0),console.log("Error checking for pending form review:",e.t0),e.abrupt("return",!1);case 23:case"end":return e.stop()}},e,this,[[0,19]])})),function(){return h.apply(this,arguments)})},{key:"renderJobTitle",value:function(){var e=this;this.shadowRoot.querySelectorAll(".job-title").forEach(function(t){var n;t.innerText=e.options.jobTitle||(null===(n=document.querySelector("#job-title"))||void 0===n?void 0:n.innerText)||document.querySelector("title").innerText.split("|")[0].trim()}),this.shadowRoot.querySelectorAll(".client-name").forEach(function(e){e.innerText=document.querySelector("#client").innerText})}},{key:"prepareSelectors",value:function(){var e=this;this.applyWebContainer=this.shadowRoot.querySelector(".eapply-web-container"),this.eApplyPopUp=this.shadowRoot.querySelector(".eapply-popup"),this.continueAplyingContainer=this.shadowRoot.querySelector("#continue-applying-container"),this.chatInput=this.shadowRoot.querySelector(".chat-input"),this.applyButtons=document.querySelectorAll(".apply-now, .apply-btn"),this.sendButton=this.shadowRoot.querySelector(".btn-send"),this.continueAplyingContainer.addEventListener("click",function(){e.maxmizeApplyChat()})}},{key:"scrollToBottom",value:function(){var e=this.shadowRoot.querySelector(".eapply-popup .chat-messages");e&&(e.scrollTop=e.scrollHeight)}},{key:"toggleViewModal",value:function(){var e=this,t=function(){if(e.maxmizeApplyChat(),window.localStorage.getItem(window.location.href)!==window.location.href){var t=e.getMessages();e.scrollToBottom(),(0===t.length||t[t.length-1]&&"system"!==t[t.length-1].initiator)&&e.sendMessage("SIGNAL_APPLY"),window.localStorage.setItem(window.location.href,window.location.href)}};this.options.autoStart&&t(),this.applyButtons.forEach(function(e){e.classList.remove("hidden"),e.addEventListener("click",function(e){e.preventDefault(),t()})}),this.shadowRoot.querySelectorAll(".close-popup").forEach(function(t){t.addEventListener("click",function(){e.minimizeApplyChat()})})}},{key:"minimizeApplyChat",value:function(){this.continueAplyingContainer.classList.remove("hide"),this.applyWebContainer.classList.remove("popup-opened"),this.eApplyPopUp.classList.add("hide")}},{key:"maxmizeApplyChat",value:function(){this.continueAplyingContainer.classList.add("hide"),this.eApplyPopUp.classList.remove("hide"),this.applyWebContainer.classList.add("popup-opened")}},{key:"sendMessageEvents",value:function(){var e=this;this.chatInput.addEventListener("keydown",function(t){if(x.includes(t.code)){var n=!t.target.value;e.updateMessageFormAndSendMessage(t.target.value,n)}}),this.sendButton.addEventListener("click",function(){e.updateMessageFormAndSendMessage(e.chatInput.value)})}},{key:"sendMessage",value:function(e,t){var n=this,o=!1;if(e||t){if(!e&&t&&(e="skip"),this.canRender())e&&"SIGNAL_APPLY"!==e&&this.renderLoadingImage();else{var s=this.anonymousApply(e).user;if(!s)return;o=!0,this.renderMessage("Please hold on a moment while we are creating a profile for you to continue applying...",!1,"started"),this.renderLoadingImage(),e=JSON.stringify(s)}window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",headers:{"x-api-token":this.token,"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken(),answer:e,userClickedApplyWebButton:!0})}).then(function(e){return e.json()}).then(function(e){if(n.restoreSendButton(),o&&e.userId&&n.dispatchEvent(new window.CustomEvent("user-signup",{detail:{userId:e.userId}})),"FORM_REVIEW"===e.type)return n.removeLoadingIndicator(),n.disableChatInput(),n.renderFormReview(e.formsData),void setTimeout(function(){n.enableReviewButtons(),n.disableChatInput()},100);if("FORM_MODAL"!==e.type){if(n.removeLoadingIndicator(),"submitted"===e.appUserStatus||"SUBMITTED"===e.type)return e.message&&n.renderMessage(e.message,!1,e.appUserStatus),n.disableChatInput(),n.disableReviewButtons(),void(e.daliaApplyToken&&window.localStorage.setItem(S,e.daliaApplyToken));e.message&&n.renderMessage(e.message,!1,e.appUserStatus),(!e.message.includes("<form>")||n.isIcimsApply&&!e.message.includes("*"))&&(e.message.includes('data-searchable-select="true"')||n.isFormContextMessage(e.message)||n.enableChatInput(),setTimeout(function(){n.isFormContextMessage(e.message)||n.chatInput.focus()},100)),n.currentFormsData&&setTimeout(function(){n.enableReviewButtons()},100),e.daliaApplyToken&&window.localStorage.setItem(S,e.daliaApplyToken),setTimeout(function(){var e=n.shadowRoot.querySelector('input[data-searchable-select="true"]:not([disabled])'),t=n.shadowRoot.querySelector(".chat-messages form:not([data-form-submitted])"),o=n.shadowRoot.querySelector(".form-review-container"),s=(0,i.Z)(n.shadowRoot.querySelectorAll(".bubble-container")).at(-1),a=((null==s?void 0:s.textContent)||"").includes("What is your location");!(e||t||o||a)&&n.chatInput&&n.chatInput.disabled&&n.enableChatInput()},200)}else{n.handleFormModal(e),n.removeLoadingIndicator(100),e.completed&&(!0===e.isEditMode&&n.currentFormsData?setTimeout(function(){n.removeLoadingIndicator(),n.showFormEditSuccess(e.formName),n.enableReviewButtons(),n.sendMessage("FORM SUBMITTED")},300):setTimeout(function(){n.removeLoadingIndicator(),n.sendMessage("FORM SUBMITTED")},300))}})}}},{key:"updateMessageFormAndSendMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;if(!t&&n){var o=(0,i.Z)(this.shadowRoot.querySelectorAll(".bubble-container")).at(-1).textContent;if(o.endsWith("*"))return this.renderMessage("This question is required");if(o.includes("This question is required"))return;return this.disableChatInput(),void this.sendMessage(t,n)}if(t){this.disableChatInput(),this.renderMessage("object"===(0,s.Z)(t)?t.text:t,!0,null),this.chatInput.value="";setTimeout(function t(){e.chatInput.hasAttribute("disabled")?setTimeout(t,100):e.chatInput.focus()},500),this.sendMessage("object"===(0,s.Z)(t)?t.value:t)}}},{key:"renderLoadingImage",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.removeLoadingIndicator(),this.chatInput&&this.disableChatInput(),this.disableReviewButtons(),e&&this.sendButton&&(this.sendButton.classList.add("loading"),this.sendButton.disabled=!0,this.sendButton.dataset.originalContent||(this.sendButton.dataset.originalContent=this.sendButton.innerHTML),this.sendButton.innerHTML='\n        <svg class="loading-spinner" width="16" height="16" viewBox="0 0 16 16" fill="none">\n          <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="2" fill="none" opacity="0.3"/>\n          <path d="M8 2 A6 6 0 0 1 14 8" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round">\n            <animateTransform attributeName="transform" type="rotate" dur="1s" repeatCount="indefinite" values="0 8 8;360 8 8"/>\n          </path>\n        </svg>\n      ');var t=this.shadowRoot.querySelector(".chat-messages .content");if(t){var n=document.createElement("template");n.innerHTML='<div class="bubble-container loading-message">\n      <div class="bubble" style="background: #FFF">\n        <div><img style="width:65px" src="'.concat(this.options.baseUrl,"/").concat(this.options.loadingGifPath,'"></div>\n      </div>\n    </div>'),t.appendChild(n.content.cloneNode(!0))}else console.warn("Chat messages content not found, cannot render loading image")}},{key:"restoreSendButton",value:function(){this.sendButton&&this.sendButton.dataset.originalContent&&(this.sendButton.classList.remove("loading"),this.sendButton.disabled=!1,this.sendButton.innerHTML=this.sendButton.dataset.originalContent)}},{key:"removeLoadingIndicator",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=function(){var t=e.shadowRoot.querySelector(".bubble-container.loading-message"),n=e.shadowRoot.querySelector(".loading-message");t&&t.remove(),n&&n!==t&&n.remove()};t>0?setTimeout(n,t):n()}},{key:"renderMessage",value:function(e){var t,n=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!this.options.blackListMessagesContains.some(function(t){return e&&e.includes(t)}))if(o||this.removeLoadingIndicator(),this.isFormContextMessage(e))this.handleFormContext(e);else{var a=document.createElement("template");if(!i&&e&&"already_applied"!==s){e=e.replace(/((http|https|ftp):\/\/[\w?=&.-;#~%-]+(?![\w\s?&.;#~%"=-]*>))/g,'<a href="$1" target="_blank">Click Here</a>')}if(a.innerHTML='<div class="bubble-container '.concat(o?"from-user":"",'">\n      <div class="bubble">\n        ').concat(i?e:"<div>".concat(e,"</div>"),"\n      </div>\n    </div>"),!o&&("What is your location?"===e||null!==(t=e)&&void 0!==t&&t.includes("home address"))){var r,l=document.createElement("div");l.setAttribute("id","geocoder-container"),l.classList.add("bubble-container"),o&&l.classList.add("from-user"),l.innerHTML='<div class="bubble" style="padding: 0.5rem !important; overflow: visible !important;"></div>',this.shadowRoot.querySelector(".chat-messages .content").appendChild(l),this.initGeocoder(l,w({},null!==(r=e)&&void 0!==r&&r.includes("home address")?{placeholder:e,types:"address"}:{}));var c=this.shadowRoot.querySelector(".chat-messages"),d=setInterval(function(){n.disableChatInput(),l.querySelector("input")&&l.querySelector("input").focus(),c&&c.scrollTo(0,c.scrollHeight);var t=c.querySelectorAll(".bubble-container");"geocoder-container"!==t[t.length-1].id&&(l.innerHTML='\n          <div class="bubble">\n            <div>'.concat(e,"</div>\n          </div>"),clearInterval(d))},250)}else{this.shadowRoot.querySelector(".chat-messages .content").appendChild(a.content.cloneNode(!0));var u=this.shadowRoot.querySelector(".chat-messages");setTimeout(function(){u&&u.scrollTo(0,u.scrollHeight)},100),this.handleCustomForm(e)}this.initializeFormContextInteractions(),this.handleFormContextScroll(e),this.checkAndHideResumeUploadForms(),this.handleSubmissionComplete(s)}}},{key:"validateFileExtension",value:function(e){return!!/(\.pdf|\.docx|\.doc|\.jpg|\.jpeg|\.png|\.txt)$/i.test(e.value)||(alert("Invalid file type."),e.form.reset(),e.focus(),!1)}},{key:"handleCustomForm",value:function(e){var t=this;if(e&&e.includes("<form>")&&!this.isIcimsApply)this.disableChatInput();else if(e&&e.includes("<form>")&&this.isIcimsApply){(0,i.Z)(this.shadowRoot.querySelectorAll(".bubble-container")).at(-1).textContent.includes("*")?this.disableChatInput():this.enableChatInput()}else this.enableChatInput();this.initializeSearchableSelects();var n=this.shadowRoot.querySelectorAll(".chat-messages form");n.length&&n[n.length-1].addEventListener("submit",function(e){if(e.preventDefault(),t.customFormValue=null,(0,i.Z)(e.target.children).some(function(e){return"file"===e.type})){var n=e.target.querySelector('input[type="file"]');if(!t.validateFileExtension(n))return;t.customFormValue=n.files[0],t.customFormValue&&t.sendFile(t.customFormValue)}else if((0,i.Z)(e.target.children).some(function(e){return"date"===e.type})){var o=e.target.querySelector('input[type="date"]');o.value&&t.updateMessageFormAndSendMessage(o.value)}else if(e.target.querySelector('input[data-searchable-select="true"]')){var s=e.target.querySelector('input[data-searchable-select="true"]'),a=e.target.querySelector('input[name="answer"]');if(!a||!a.value)return void t.renderMessage("Please select an option from the list",!1,null);t.updateMessageFormAndSendMessage({text:s.value,value:a.value})}else{var r=(0,i.Z)(e.target.querySelectorAll('input[name="answer"]:checked'));if(!r.length)return;t.updateMessageFormAndSendMessage({text:r.map(function(e){return e.nextElementSibling.innerText}).join(", "),value:r.map(function(e){return e.value}).join(",")})}e.target.querySelector("button")&&e.target.querySelector("button").remove(),e.target.querySelectorAll("input").forEach(function(e){e.setAttribute("disabled","disabled")})}),n.length>1&&n.forEach(function(e,t){t!==n.length-1&&(e.querySelector("button")&&e.querySelector("button").remove(),e.querySelectorAll("input").forEach(function(e){e.remove()}))}),this.shadowRoot.querySelectorAll(".question-skip-btn").forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();var o=t.shadowRoot.querySelectorAll(".question-skip-btn"),s=t.shadowRoot.querySelectorAll("*"),i=Array.from(s).filter(function(e){return e.textContent&&"skip"===e.textContent.trim().toLowerCase()&&"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName});t.updateMessageFormAndSendMessage("skip"),e.textContent="Skipped",e.disabled=!0,e.style.color="#adb5bd",e.style.cursor="not-allowed",e.style.opacity="0.6";var a=e.closest("form");a&&a.querySelectorAll("input, button").forEach(function(e){e.setAttribute("disabled","disabled")}),o.forEach(function(t){t!==e&&(t.textContent="Skipped",t.disabled=!0,t.style.color="#adb5bd",t.style.cursor="not-allowed",t.style.opacity="0.6")}),i.forEach(function(t){t!==e&&(t.textContent="Skipped","BUTTON"!==t.tagName&&"A"!==t.tagName||(t.disabled=!0,t.style.color="#adb5bd",t.style.cursor="not-allowed",t.style.opacity="0.6"))})})})}},{key:"initializeSearchableSelects",value:function(){var e=this,t=this.shadowRoot.querySelectorAll('input[data-searchable-select="true"]');Array.from(t).filter(function(e){return!e.hasAttribute("data-initialized")}).length>0&&this.disableChatInput(),t.forEach(function(t){if(!t.hasAttribute("data-initialized")){var n=t.closest(".searchable-select-container"),o=n.querySelector(".searchable-select-dropdown"),s=o.querySelector(".searchable-select-options"),i=n.querySelector('input[name="answer"]'),a=n.parentElement.querySelector("button.eapply-btn"),r=[];try{var l=t.getAttribute("data-options");r=JSON.parse(l.replace(/&quot;/g,'"'))}catch(e){return void console.error("Failed to parse searchable select options:",e)}t.setAttribute("data-initialized","true"),t.removeAttribute("readonly"),t.addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation(),t.style.transform="translateY(-1px)"}),t.addEventListener("blur",function(){setTimeout(function(){t.style.transform="translateY(0)"},200)}),t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e.disableChatInput(),e.showDropdown(o,s,r,t,i,a)}),t.addEventListener("input",function(n){if(!t.hasAttribute("data-selecting")){var l=n.target.value.toLowerCase();e.filterOptions(s,r,l,t,i,a),e.showDropdown(o,s,r,t,i,a)}});var c=function(t){n.contains(t.target)||o.contains(t.target)||o.classList.contains("show")&&e.hideDropdown(o)};document.addEventListener("click",c,!0),o.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()}),e.addEventListener("remove",function(){document.removeEventListener("click",c,!0)})}})}},{key:"showDropdown",value:function(e,t,n,o,s,i){if(0!==n.length){var a=o.value.toLowerCase();this.filterOptions(t,n,a,o,s,i);var r=o.getBoundingClientRect(),l=Math.min(300,52*n.length),c=window.innerHeight-r.bottom,d=r.top,u=o.closest(".eapply-popup"),p=u?u.getBoundingClientRect():null,h=c<l&&d>c;if(p){var f=r.top-p.top,v=p.bottom-r.bottom;h&&f<l&&(h=!1),!h&&v<l&&(h=!0)}h?(e.style.top="auto",e.style.bottom="calc(100% + 2px)",e.style.borderRadius="8px 8px 0 0",e.style.transformOrigin="bottom center"):(e.style.top="calc(100% + 2px)",e.style.bottom="auto",e.style.borderRadius="8px",e.style.transformOrigin="top center"),e.classList.add("show"),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("transform","translateY(0)","important"),e.style.setProperty("pointer-events","auto","important"),this.disableChatInput(),e.offsetHeight}}},{key:"hideDropdown",value:function(e){e.classList.remove("show"),e.style.setProperty("opacity","0","important"),e.style.setProperty("transform","translateY(-10px)","important"),e.style.setProperty("pointer-events","none","important"),e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important");var t=this.shadowRoot.querySelectorAll('input[data-searchable-select="true"]:not([disabled])').length>0,n=this.shadowRoot.querySelectorAll(".chat-messages form:not([data-form-submitted])").length>0;t||n||this.enableChatInput()}},{key:"disableChatInput",value:function(){this.chatInput&&(this.chatInput.disabled=!0,this.chatInput.placeholder="Complete your selection first...",this.chatInput.style.opacity="0.5",this.chatInput.style.cursor="not-allowed",this.chatInput.setAttribute("disabled","disabled"),this.sendButton&&(this.sendButton.disabled=!0,this.sendButton.style.opacity="0.5",this.sendButton.style.cursor="not-allowed"))}},{key:"enableChatInput",value:function(){this.chatInput&&(this.chatInput.disabled=!1,this.chatInput.placeholder="Type your message...",this.chatInput.style.opacity="1",this.chatInput.style.cursor="text",this.sendButton&&(this.sendButton.disabled=!1,this.sendButton.style.opacity="1",this.sendButton.style.cursor="pointer"))}},{key:"lockBodyScroll",value:function(){var e=document.body,t=document.documentElement;this._scrollPosition=window.pageYOffset||document.documentElement.scrollTop,e.style.position="fixed",e.style.top="-".concat(this._scrollPosition,"px"),e.style.width="100%",e.style.overflow="hidden",t.style.overflow="hidden"}},{key:"unlockBodyScroll",value:function(){var e=document.body,t=document.documentElement;e.style.position="",e.style.top="",e.style.width="",e.style.overflow="",t.style.overflow="",void 0!==this._scrollPosition&&(window.scrollTo(0,this._scrollPosition),this._scrollPosition=void 0)}},{key:"applyTruncationState",value:function(e,t){if(e){var n=e.querySelector(".form-modal-content"),o=e.querySelector(".form-modal-message-section:first-of-type");t?(n&&(n.classList.add("content-truncated"),n.classList.remove("content-expanded")),o&&(o.classList.add("message-truncated"),o.classList.remove("message-expanded"))):(n&&(n.classList.remove("content-truncated"),n.classList.add("content-expanded")),o&&(o.classList.remove("message-truncated"),o.classList.add("message-expanded")))}}},{key:"collapseFormContent",value:function(e,t,n,o){var s=e.querySelectorAll(".form-modal-message-section"),i=e.querySelectorAll(".form-modal-questions-section");s.forEach(function(e,t){t>0&&(e.style.display="none")}),i.forEach(function(e){e.style.display="none"}),this.applyTruncationState(e,!0),t.querySelector(".continue-reading-text").textContent="Continue reading",n&&(n.style.transform="rotate(0deg)");var a=e.querySelector(".form-modal-finish-wrapper");a&&(a.style.display="none"),o&&(o.disabled=!0)}},{key:"expandFormContent",value:function(e,t,n,o){var s=e.querySelectorAll(".form-modal-message-section"),i=e.querySelectorAll(".form-modal-questions-section");s.forEach(function(e){e.style.display="block"}),i.forEach(function(e){e.style.display="flex"}),this.applyTruncationState(e,!1),t.querySelector(".continue-reading-text").textContent="Show less",n&&(n.style.transform="rotate(180deg)");var a=e.querySelector(".form-modal-finish-wrapper");a&&(a.style.display=""),o&&(o.disabled=!1),i.length>0&&setTimeout(function(){i[0].scrollIntoView({behavior:"smooth",block:"start"})},200)}},{key:"filterOptions",value:function(e,t,n,s,i,a){var r=this;e.innerHTML="";var l=this.enhancedSearch(t,n),c=l.slice(0,50);if(!n){var d=document.createElement("div");d.className="searchable-search-header",d.innerHTML='\n        <div class="search-results-info">\n          <span class="results-count">'.concat(c.length," option").concat(1!==c.length?"s":"",' available</span>\n          <span class="search-term">Type to search</span>\n        </div>\n      '),e.appendChild(d);var u=s.getAttribute("data-question-context")||"",p=this.groupOptionsByType(c,u);Object.entries(p).forEach(function(t){var n=(0,o.Z)(t,2),l=n[0],c=n[1];if(c.length>0){var d=document.createElement("div");d.className="searchable-group-header",d.textContent=l,e.appendChild(d)}c.forEach(function(t,n){var o=document.createElement("div");o.className="searchable-option",o.dataset.value=t.value,o.dataset.index=n;var l=r.createEnhancedOptionDisplay(t,"",u);o.innerHTML=l,o.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r.selectOption(t,s,i,a)}),o.addEventListener("mouseenter",function(){e.querySelectorAll(".searchable-option").forEach(function(e){e.classList.remove("selected")}),o.classList.add("selected")}),e.appendChild(o)})});var h=document.createElement("div");return h.className="searchable-keyboard-hint",h.innerHTML='\n        <div class="keyboard-shortcuts">\n          <span class="shortcut"><kbd>Enter</kbd> Select</span>\n          <span class="shortcut"><kbd>Esc</kbd> Close</span>\n        </div>\n      ',void e.appendChild(h)}if(n&&l.length>0){var f=document.createElement("div");f.className="searchable-search-header",f.innerHTML='\n        <div class="search-results-info">\n          <span class="results-count">'.concat(l.length," result").concat(1!==l.length?"s":"",' found</span>\n          <span class="search-term">for "').concat(n,'"</span>\n        </div>\n      '),e.appendChild(f)}var v=s.getAttribute("data-question-context")||"",m=this.groupOptionsByType(c,v);if(Object.entries(m).forEach(function(t){var l=(0,o.Z)(t,2),c=l[0],d=l[1];if(d.length>0){var u=document.createElement("div");u.className="searchable-group-header",u.textContent=c,e.appendChild(u)}d.forEach(function(t,o){var l=document.createElement("div");l.className="searchable-option",l.dataset.value=t.value,l.dataset.index=o;var c=r.createEnhancedOptionDisplay(t,n,v);l.innerHTML=c,l.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r.selectOption(t,s,i,a)}),l.addEventListener("mouseenter",function(){e.querySelectorAll(".searchable-option").forEach(function(e){e.classList.remove("selected")}),l.classList.add("selected")}),e.appendChild(l)})}),0===l.length){var y=document.createElement("div");y.className="searchable-no-results",y.innerHTML='\n        <div class="no-results-icon">üîç</div>\n        <div class="no-results-text">\n          <div class="no-results-title">No options found matching "'.concat(n,'"</div>\n          <div class="no-results-suggestions">\n            <div class="suggestion-title">Try these suggestions:</div>\n            <ul class="suggestion-list">\n              <li>Check your spelling</li>\n              <li>Try a shorter search term</li>\n              <li>Use partial names (e.g., "Alabama" instead of "Alabama A&M")</li>\n              <li>Select "Other" if your school isn\'t listed</li>\n            </ul>\n          </div>\n        </div>\n      '),e.appendChild(y)}if(l.length>50){var g=document.createElement("div");g.className="searchable-more-info",g.innerHTML='\n        <div class="more-results-info">\n          <span class="showing-text">Showing first 50 of '.concat(l.length,' results</span>\n          <span class="narrow-text">Type more to narrow your search</span>\n        </div>\n      '),e.appendChild(g)}if(1===l.length&&l[0].text.toLowerCase()===n.toLowerCase()){var w=e.querySelector(".searchable-option");w&&w.classList.add("selected")}if(l.length>0){var b=document.createElement("div");b.className="searchable-keyboard-hint",b.innerHTML='\n        <div class="keyboard-shortcuts">\n          <span class="shortcut"><kbd>Enter</kbd> Select</span>\n          <span class="shortcut"><kbd>Esc</kbd> Close</span>\n        </div>\n      ',e.appendChild(b)}}},{key:"enhancedSearch",value:function(e,t){var n=this;if(!t)return e.slice(0,50);var o=t.toLowerCase().trim(),s=[];return e.forEach(function(e){var t=e.text.toLowerCase(),i=e.value.toLowerCase();t===o||i===o?s.unshift(w(w({},e),{},{score:100,matchType:"exact"})):t.startsWith(o)||i.startsWith(o)?s.push(w(w({},e),{},{score:90,matchType:"starts-with"})):t.includes(o)||i.includes(o)?s.push(w(w({},e),{},{score:80,matchType:"contains"})):n.hasWordBoundaryMatch(t,o)&&s.push(w(w({},e),{},{score:70,matchType:"word-boundary"}))}),s.sort(function(e,t){return t.score-e.score}),s}},{key:"hasWordBoundaryMatch",value:function(e,t){return e.split(/\s+/).some(function(e){return e.startsWith(t)})}},{key:"groupOptionsByType",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").toLowerCase();return t.includes("school")||t.includes("university")||t.includes("college")||t.includes("education")?this.groupBySchoolType(e):t.includes("major")||t.includes("degree")||t.includes("field of study")?this.groupByDegreeType(e):t.includes("job title")||t.includes("position")||t.includes("role")?this.groupByJobCategory(e):{Options:e}}},{key:"groupBySchoolType",value:function(e){var t={Universities:[],Colleges:[],"High Schools":[],"Technical Schools":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("university")?t.Universities.push(e):n.includes("college")?t.Colleges.push(e):n.includes("high school")||n.includes("high")?t["High Schools"].push(e):n.includes("technical")||n.includes("tech")||n.includes("institute")?t["Technical Schools"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"groupByDegreeType",value:function(e){var t={"Bachelor's Degrees":[],"Master's Degrees":[],"Associate's Degrees":[],"Certificates & Diplomas":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("bachelor")||n.includes("ba ")||n.includes("bs ")||n.includes("b.s.")||n.includes("b.a.")?t["Bachelor's Degrees"].push(e):n.includes("master")||n.includes("ma ")||n.includes("ms ")||n.includes("m.s.")||n.includes("m.a.")?t["Master's Degrees"].push(e):n.includes("associate")||n.includes("aa ")||n.includes("as ")||n.includes("a.s.")||n.includes("a.a.")?t["Associate's Degrees"].push(e):n.includes("certificate")||n.includes("diploma")||n.includes("certification")?t["Certificates & Diplomas"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"groupByJobCategory",value:function(e){var t={Management:[],Technical:[],Administrative:[],"Sales & Marketing":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("manager")||n.includes("director")||n.includes("supervisor")||n.includes("lead")||n.includes("chief")?t.Management.push(e):n.includes("engineer")||n.includes("developer")||n.includes("analyst")||n.includes("specialist")||n.includes("technician")?t.Technical.push(e):n.includes("assistant")||n.includes("coordinator")||n.includes("administrator")||n.includes("clerk")?t.Administrative.push(e):n.includes("sales")||n.includes("marketing")||n.includes("representative")||n.includes("account")?t["Sales & Marketing"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"createEnhancedOptionDisplay",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=e.text;if(t){var s=new RegExp("(".concat(t,")"),"gi");o=e.text.replace(s,'<strong class="highlight">$1</strong>')}var i="",a=n.toLowerCase();return i=a.includes("school")||a.includes("university")||a.includes("college")||a.includes("education")?e.text.toLowerCase().includes("university")?'<span class="type-indicator university">üèõÔ∏è</span>':e.text.toLowerCase().includes("college")?'<span class="type-indicator college">üéì</span>':e.text.toLowerCase().includes("high school")?'<span class="type-indicator high-school">üè´</span>':e.text.toLowerCase().includes("technical")?'<span class="type-indicator technical">‚öôÔ∏è</span>':'<span class="type-indicator other">üîç</span>':a.includes("major")||a.includes("degree")||a.includes("field of study")?e.text.toLowerCase().includes("bachelor")||e.text.toLowerCase().includes("master")||e.text.toLowerCase().includes("associate")?'<span class="type-indicator degree">üéì</span>':e.text.toLowerCase().includes("certificate")?'<span class="type-indicator certificate">üìú</span>':'<span class="type-indicator other">üìö</span>':a.includes("job title")||a.includes("position")||a.includes("role")?e.text.toLowerCase().includes("manager")||e.text.toLowerCase().includes("director")?'<span class="type-indicator management">üëî</span>':e.text.toLowerCase().includes("engineer")||e.text.toLowerCase().includes("developer")?'<span class="type-indicator technical">üíª</span>':e.text.toLowerCase().includes("assistant")||e.text.toLowerCase().includes("coordinator")?'<span class="type-indicator admin">üìã</span>':'<span class="type-indicator job">üíº</span>':a.includes("location")||a.includes("city")||a.includes("state")?'<span class="type-indicator location">üìç</span>':'<span class="type-indicator default">üìù</span>','\n      <div class="option-content">\n        <div class="option-main">\n          '.concat(i,'\n          <span class="option-text">').concat(o,"</span>\n        </div>\n      </div>\n    ")}},{key:"selectOption",value:function(e,t,n,o){t.setAttribute("data-selecting","true"),t.value=e.text,n.value=e.value,t.style.borderColor="#48bb78",t.style.boxShadow="0 0 0 4px rgba(72, 187, 120, 0.1)",o&&(o.classList.remove("button-disabled"),o.style.animation="buttonPulse 0.6s ease-out");var s=t.closest(".searchable-select-container").querySelector(".searchable-select-dropdown");s&&this.hideDropdown(s),setTimeout(function(){t.removeAttribute("data-selecting")},100),setTimeout(function(){t.style.borderColor="",t.style.boxShadow=""},2e3),t.focus()}},{key:"isUserApplied",value:function(e){return["submit_success","questions_complete","submitted","already_applied"].includes(e)}},{key:"displayJobs",value:function(e){if(!e||0===e.length){var t=this.shadowRoot.querySelector(".eapply-popup");t&&t.remove()}var n=this.applyWebContainer;if(n){n.classList.add("popup-opened");var o=n.querySelector(".completed");o&&o.classList.remove("complete");var s=n.querySelector(".chat-messages"),i=n.querySelector(".chat-controls"),a=n.querySelector(".show-jobs");s&&(s.style.display="none"),i&&(i.style.display="none"),a&&(a.style.display="block");var r=this.shadowRoot.querySelector(".eapply-popup .chat-container .show-jobs");r&&(r.innerHTML='<p class="show-jobs-title">Similar jobs based on your interests</p>',e.forEach(function(e){var t=document.createElement("div");t.classList.add("job-item","job-card");var n=document.createElement("h3");if(n.textContent=e.title,n.classList.add("job-title"),t.appendChild(n),e.addresses&&e.addresses.length>0){var o=document.createElement("p");o.textContent="Location: ".concat(e.addresses[0].city,", ").concat(e.addresses[0].state),o.classList.add("job-location"),t.appendChild(o)}var s=document.createElement("a");s.href=e.url,s.textContent="Apply Now",s.classList.add("apply-button"),s.target="_blank",t.appendChild(s),r.appendChild(t)}))}}},{key:"handleSubmissionComplete",value:function(e){var t=this;if(e&&!["invited","started","questions_started","confirm_stop","invalid_answers_limit_exceeded","declined"].includes(e))if(this.isUserApplied(e)){var n,o,s,i="already_applied"===e;if(!i&&this.applyWebContainer.querySelector(".completed").classList.add("complete"),this.applyButtons.forEach(function(e){e.classList.remove("hidden"),e.style.backgroundColor=i?"#A2A2A2":"#21c492",e.innerText="You ".concat(i?"already":""," applied to this job")}),null!==(n=this.options.postApplySuggestions)&&void 0!==n&&n.enabled&&null!==(o=this.options.postApplySuggestions)&&void 0!==o&&o.delay){var a,r=(null===(a=this.options.postApplySuggestions)||void 0===a?void 0:a.delay)||3e3;setTimeout(function(){t.showRelevantJobs()},r)}else null!==(s=this.options.postApplySuggestions)&&void 0!==s&&s.enabled&&this.showRelevantJobs()}else this.applyButtons.forEach(function(e){e.classList.remove("hidden"),e.addEventListener("click",function(e){e.target.getAttribute("href")&&(window.location.href=e.target.getAttribute("href"))})}),this.applyWebContainer.remove()}},{key:"showRelevantJobs",value:function(){var e=this;window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.webReapplyPath),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken()})}).then(function(e){return e.json()}).then(function(t){e.displayJobs(t.jobs)})}},{key:"sendFile",value:function(e){var t=this;this.renderLoadingImage();var n=e.name||"Resume.pdf",o=new FormData;o.append("answer",e),o.append("daliaApplyToken",this.getUserToken()),window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",body:o}).then(function(e){return e.json()}).then(function(e){if(t.restoreSendButton(),"FORM_MODAL"===e.type){var o=t.extractResumeUrlFromResponse(e);if(o){var s=t.formatResumeAnswer(o,n);t.renderMessage(s,!0,e.appUserStatus,!0),setTimeout(function(){return t.hideResumeUploadForms()},100),t.removeLoadingIndicator(100)}return t.handleFormModal(e),t.removeLoadingIndicator(100),void(e.completed&&setTimeout(function(){t.removeLoadingIndicator(),t.sendMessage("FORM SUBMITTED")},300))}if("FORM_REVIEW"===e.type){var i=t.extractResumeUrlFromResponse(e);if(i){var a=t.formatResumeAnswer(i,n);t.renderMessage(a,!0,e.appUserStatus,!0),setTimeout(function(){return t.hideResumeUploadForms()},100)}return t.removeLoadingIndicator(),t.disableChatInput(),t.renderFormReview(e.formsData),void setTimeout(function(){t.enableReviewButtons(),t.disableChatInput()},100)}if("submitted"===e.appUserStatus||"SUBMITTED"===e.type)return t.removeLoadingIndicator(),void(e.message&&t.renderMessage(e.message,!1,e.appUserStatus));var r=t.extractResumeUrlFromResponse(e);if(t.removeLoadingIndicator(),r){var l=t.formatResumeAnswer(r,n);t.renderMessage(l,!0,e.appUserStatus,!0),setTimeout(function(){return t.hideResumeUploadForms()},100),e.message&&!e.message.includes(r)&&setTimeout(function(){t.renderMessage(e.message,!1,e.appUserStatus)},100)}else t.renderMessage(e.message,!1,e.appUserStatus)}).catch(function(e){t.removeLoadingIndicator(),t.restoreSendButton(),console.error("Error uploading file:",e),t.renderMessage("An error occurred while uploading your resume. Please try again.",!1,null)})}},{key:"extractResumeUrlFromResponse",value:function(e){var t=e.resumeUrl;return"string"==typeof t&&t.includes("storage.googleapis.com")?t:null}},{key:"initGeocoder",value:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{o=w({types:"place,locality,neighborhood",placeholder:"What is your location?",countries:"us,ca"},o);var s=document.createElement("div");s.innerHTML=o.placeholder;var i=s.textContent.trim(),a=document.createElement("style");a.textContent="\n        .mapboxgl-ctrl-geocoder {\n          box-shadow: none !important;\n        }\n        .mapboxgl-ctrl-geocoder--input {\n          padding: 6px 10px !important;\n        }\n        .suggestions-wrapper {\n          background: #f5f5f5 !important;\n        }\n      ",this.shadowRoot.appendChild(a);var r=document.createElement("link");r.rel="stylesheet",r.href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.css",this.shadowRoot.appendChild(r),n.e(48).then(n.bind(n,9048)).then(function(n){var s=new(0,n.default)({getItemValue:function(e){return e.address},placeholder:i,countries:o.countries,types:o.types,language:"en",minLength:3,limits:5,clientName:"Dalia",APIURL:"".concat(t.options.baseUrl,"/api"),clearAndBlurOnEsc:!0,clearOnBlur:!1,collapsed:!1});e.querySelector(".bubble").appendChild(s.onAdd()),s.on("result",function(e){if(e){t.enableChatInput(),t.updateMessageFormAndSendMessage(e);var n=t.shadowRoot.querySelector(".geocoder-container");n&&n.remove()}})})}catch(e){console.error("Error initializing geocoder:",e),this.enableChatInput()}}},{key:"isFormContextMessage",value:function(e){try{var t=e;if("string"==typeof e){var n=e;if(e.includes("<p>")&&e.includes("</p>")&&e.includes("formName")){if(e.startsWith("<p>")&&e.endsWith("</p>"))n=e.slice(3,-4);else if(e.includes("formName")&&e.startsWith("{"))n=e;else{var o=e.indexOf("<p>"),i=e.lastIndexOf("</p>");-1!==o&&-1!==i&&i>o&&(n=e.slice(o+3,i))}n=n.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}try{t=JSON.parse(n)}catch(e){return!1}}return t&&"object"===(0,s.Z)(t)&&t.formName&&t.messages&&t.formContextKey&&Array.isArray(t.messages)}catch(e){return!1}}},{key:"handleFormContext",value:function(e){var t=this;try{var n=e;if("string"==typeof e){var o=e;if(e.includes("<p>")&&e.includes("</p>")&&e.includes("formName")){if(e.startsWith("<p>")&&e.endsWith("</p>"))o=e.slice(3,-4);else{var s=e.indexOf("<p>"),i=e.lastIndexOf("</p>");-1!==s&&-1!==i&&i>s&&(o=e.slice(s+3,i))}o=o.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}try{n=JSON.parse(o)}catch(e){return}}var a="form_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r='\n        <div class="form-context-container" data-form-id="'.concat(a,'">\n          <div class="form-header">\n            <h3 class="form-title">').concat(n.formName,'</h3>\n            <div class="form-subtitle">Please read the information below, then answer the questions that follow.</div>\n          </div>\n          <div class="form-messages">\n            <div class="form-messages-content" data-form-id="').concat(a,'">\n              ').concat(n.messages.map(function(e){return'<div class="form-message-content">'.concat(e.replace(/\\"/g,'"').trim(),"</div>")}).join(""),'\n            </div>\n            <div class="form-messages-toggle">\n              <button class="read-more-btn" data-form-id="').concat(a,'" data-form-key="').concat(n.formContextKey,'">\n                <span class="read-more-text">Read More</span>\n                <svg class="read-more-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none">\n                  <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                </svg>\n              </button>\n            </div>\n          </div>\n          <div class="form-ready-indicator">\n            <button class="continue-btn" data-form-id="').concat(a,'" data-form-key="').concat(n.formContextKey,'">\n              <span>Continue to Questions</span>\n              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">\n                <path d="M8 1L15 8L8 15M15 8H1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </button>\n          </div>\n        </div>\n      ');this.renderRegularMessage(r,!1),this.disableChatInput(),this.scrollToBottom(),setTimeout(function(){var e=t.shadowRoot.querySelector('[data-form-id="'.concat(a,'"].read-more-btn')),n=t.shadowRoot.querySelector('[data-form-id="'.concat(a,'"].continue-btn'));e&&e.addEventListener("click",t.handleReadMoreClick.bind(t)),n&&n.addEventListener("click",function(){t.handleFormContextContinue(n)})},100)}catch(t){this.renderRegularMessage(e,!1)}}},{key:"handleReadMoreClick",value:function(e){var t=e.target.closest(".read-more-btn"),n=t.closest(".form-messages").querySelector(".form-messages-content"),o=t.querySelector(".read-more-text"),s=t.querySelector(".read-more-arrow");n.classList.contains("expanded")?(n.classList.remove("expanded"),o.textContent="Read More",s.style.transform="rotate(0deg)"):(n.classList.add("expanded"),o.textContent="Read Less",s.style.transform="rotate(180deg)")}},{key:"handleFormContextContinue",value:function(e){if(e){e.style.display="none";var t=e.closest(".form-ready-indicator");t&&(t.style.display="none")}this.updateMessageFormAndSendMessage("continue")}},{key:"renderRegularMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.createElement("template");e&&(e=e.replace(/((http|https|ftp):\/\/[\w?=&.-;#~%-]+(?![\w\s?&.;#~%"=-]*>))/g,'<a href="$1" target="_blank">Click Here</a>')),n.innerHTML='<div class="bubble-container '.concat(t?"from-user":"",'">\n      <div class="bubble">\n        <div>').concat(e,"</div>\n      </div>\n    </div>");var o=this.shadowRoot.querySelector(".chat-messages .content");o&&o.appendChild(n.content.cloneNode(!0))}},{key:"initializeFormContextInteractions",value:function(){var e=this;this.shadowRoot.querySelectorAll(".read-more-btn:not([data-initialized])").forEach(function(t){t.setAttribute("data-initialized","true"),t.addEventListener("click",function(n){n.preventDefault();var o=t.getAttribute("data-form-key");o&&e.toggleFormMessages(o)})}),this.shadowRoot.querySelectorAll(".continue-btn:not([data-initialized])").forEach(function(t){t.setAttribute("data-initialized","true"),t.addEventListener("click",function(t){t.preventDefault(),e.proceedWithQuestions()})})}},{key:"toggleFormMessages",value:function(e){var t=this,n=this.shadowRoot.getElementById("form-messages-"+e);if(n){var o=n.querySelector(".form-messages-content"),s=n.querySelector(".read-more-btn"),i=s.querySelector(".read-more-text"),a=s.querySelector(".read-more-arrow");o.classList.contains("expanded")?(o.classList.remove("expanded"),i.textContent="Read More",a.style.transform="rotate(0deg)"):(o.classList.add("expanded"),i.textContent="Show Less",a.style.transform="rotate(180deg)"),setTimeout(function(){var e=t.shadowRoot.querySelector(".chat-messages");e&&e.scrollTo(0,e.scrollHeight)},300)}}},{key:"proceedWithQuestions",value:function(){this.chatInput&&this.sendButton&&(this.chatInput.value="continue",this.sendButton.click())}},{key:"handleFormContextScroll",value:function(e){var t=this;e&&"string"==typeof e&&e.includes("form-context-container")&&setTimeout(function(){var e=t.shadowRoot.querySelectorAll(".form-context-container");if(e.length>0){var n=e[e.length-1];if(t.shadowRoot.querySelector(".chat-messages")&&n){var o=n.querySelector(".form-header")||n;o.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),o.style.transition="background-color 0.3s ease",o.style.backgroundColor="rgba(59, 130, 246, 0.1)",setTimeout(function(){o.style.backgroundColor=""},1500)}}},300)}},{key:"handleFormModal",value:function(e){this.disableChatInput(),e.completed?this.renderFormSidebar(e,!0):this.renderFormSidebar(e,!1)}},{key:"renderFormSidebar",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.shadowRoot.querySelector(".chat-messages .content");if(o){var s=o.querySelector('.form-wrapper[data-form-id="'.concat(e.formId,'"]'));s||((s=document.createElement("div")).className="form-wrapper",s.setAttribute("data-form-id",e.formId),o.appendChild(s));var i=s.querySelector(".apply-sidebar-container");i||((i=document.createElement("div")).className="apply-sidebar-container",s.appendChild(i));var a="";if(n){var r=e.items.filter(function(e){return"QUESTION"===e.type}),l="";r.forEach(function(e){var t=e.question||"Question will be here",n=e.answer||"Not answered",o=e.isSkipped||"Skipped"===n||"No answer provided"===n;l+='\n          <div class="form-sidebar-answer-item" data-question-id="'.concat(e.id,'">\n            <div class="form-sidebar-answer-content">\n              <div class="form-sidebar-answer-label">').concat(t,'</div>\n              <div class="form-sidebar-answer-value ').concat(o?"form-sidebar-answer-skipped":"",'">').concat(n,"</div>\n            </div>\n          </div>\n        ")}),a='\n        <div class="form-sidebar-item" data-form-id="'.concat(e.formId,'">\n          <div class="form-sidebar-header">\n            <div class="form-sidebar-icon">\n              <svg width="34" height="34" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n                <path d="M14 2V8H20" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 13H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 17H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n            <div class="form-sidebar-title">\n              <div class="form-sidebar-name">').concat(e.formName,' *</div>\n              <div class="form-sidebar-instruction">Please read the information in this form, then answer the questions that follow.</div>\n            </div>\n          </div>\n          <div class="form-sidebar-read-success">\n            <span class="form-sidebar-read-success-text">*Read Successfully</span>\n            <svg class="form-sidebar-read-success-check" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <circle cx="12" cy="12" r="10" stroke="#10B981" stroke-width="2" fill="none"/>\n              <path d="M9 12L11 14L15 10" stroke="#10B981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n          </div>\n          <div class="form-sidebar-edit-note">\n            <p>You can edit your answers in the review step at the end of the application.</p>\n          </div>\n          <div class="form-sidebar-answers-container">\n            ').concat(l,"\n          </div>\n        </div>\n      ")}else a='\n        <div class="form-sidebar-item form-sidebar-item-initial" data-form-id="'.concat(e.formId,'">\n          <div class="form-sidebar-header">\n            <div class="form-sidebar-icon">\n              <svg width="34" height="34" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n                <path d="M14 2V8H20" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 13H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 17H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n            <div class="form-sidebar-title">\n              <div class="form-sidebar-name">').concat(e.formName,' *</div>\n              <div class="form-sidebar-instruction">Please read the information in this form, then answer the questions that follow.</div>\n            </div>\n          </div>\n          <button class="form-sidebar-read-btn" data-form-id="').concat(e.formId,'">\n            <span>Read the form (Required)</span>\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n          </button>\n          <div class="form-sidebar-note">*Reading the form is required to continue</div>\n        </div>\n      ');var c=i.querySelector('[data-form-id="'.concat(e.formId,'"]'));if(c?c.outerHTML=a:i.insertAdjacentHTML("beforeend",a),n);else{var d=i.querySelector('.form-sidebar-read-btn[data-form-id="'.concat(e.formId,'"]'));d&&d.addEventListener("click",function(){t.renderFormModal(e)})}setTimeout(function(){var t=i.querySelector('[data-form-id="'.concat(e.formId,'"]'));t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})},100)}else console.warn("Chat messages content not found")}},{key:"groupFormItemsByMessage",value:function(e){if(!e||!Array.isArray(e))return[];var t=[],n=null;return e.forEach(function(e){"MESSAGE"===e.type?(n&&t.push(n),n={message:e,questions:[]}):"QUESTION"===e.type&&(n?n.questions.push(e):n={message:null,questions:[e]})}),n&&t.push(n),t}},{key:"renderFormModal",value:function(e){var t,n=this;this.lockBodyScroll();var o=document.createElement("div");o.className="form-modal-overlay",o.id="form-modal-".concat(e.formId);var s=this.groupFormItemsByMessage(e.items||[]),i=(e.items||[]).filter(function(e){return"QUESTION"===e.type}),a=!0===e.readOnly,r=!0===e.isEditMode,l='\n      <div class="form-modal-container">\n        <div class="form-modal-header">\n          <h2 class="form-modal-title">'.concat(e.formName,'</h2>\n          <button class="form-modal-close" data-form-id="').concat(e.formId,'">\n            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n          </button>\n        </div>\n        ').concat(r?'\n        <div class="form-modal-warning-container">\n          <div class="form-modal-warning" style="background: #F3F4F6; border: 1px solid #6f00ff;">\n            <div class="form-modal-warning-icon">\n              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M18.5 2.5C18.8978 2.10218 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10218 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n            <div class="form-modal-warning-text" style="color: #1F2937;">Edit your answers below. Click "Save Changes" to update your form.</div>\n          </div>\n        </div>\n        ':'\n        <div class="form-modal-warning-container">\n          <div class="form-modal-warning">\n            <div class="form-modal-warning-icon">\n              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <circle cx="12" cy="12" r="11" stroke="#F4AD28" stroke-width="1.5" fill="none"/>\n                <circle cx="12" cy="8" r="1.5" fill="#F4AD28"/>\n                <path d="M12 10V16" stroke="#F4AD28" stroke-width="2" stroke-linecap="round"/>\n              </svg>\n            </div>\n            <div class="form-modal-warning-text">You can not continue applying without reading this form</div>\n          </div>\n        </div>\n        ','\n        <div class="form-modal-content">\n    '),c=r||e.completed,d=s.some(function(e){return e.message}),u=s.filter(function(e){return e.message}).length>1,p=s.some(function(e,t){return t>0&&e.questions.length>0}),h=(null===(t=s[0])||void 0===t?void 0:t.questions)&&s[0].questions.length>0,f=u||p||h,v=!0;s.forEach(function(e,t){if(e.message){var n=c||0===t?"display: block;":"display: none;";l+='\n          <div class="form-modal-message-section" data-group-index="'.concat(t,'" style="').concat(n,'">\n            <div class="form-modal-message">').concat(e.message.content,"</div>\n          </div>\n        "),v&&!c&&f&&(l+='\n            <div class="form-modal-message-continue">\n              <button class="form-modal-message-continue-btn" id="continue-reading-all-btn">\n                <span class="continue-reading-text">Continue reading</span>\n                <div class="continue-reading-arrow">\n                  <svg width="15" height="15" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M6 9L12 15L18 9" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                  </svg>\n                </div>\n              </button>\n            </div>\n          '),v=!1}if(e.questions.length>0){var o=c||!e.message&&!d&&0===t?"display: flex;":"display: none;";l+='<div class="form-modal-questions-section" data-group-index="'.concat(t,'" style="').concat(o,'">'),e.questions.forEach(function(e,t){var n=e.required?"*":"";l+='\n            <div class="form-modal-question" data-question-id="'.concat(e.id,'">\n              ').concat(t>0?'<div class="form-modal-question-divider"></div>':"",'\n              <div class="form-modal-question-label">').concat(e.question||"Question will be here").concat(n,'</div>\n              <div class="form-modal-question-answer">\n          '),e.questionOptions&&e.questionOptions.length>0?e.questionOptions.forEach(function(t){var n=e.answer===t.value||e.answer===t.label;l+='\n                <label class="form-modal-option '.concat(a?"form-modal-option-readonly":"",'">\n                  <input type="radio" name="question_').concat(e.id,'" value="').concat(t.value,'" ').concat(n?"checked":""," ").concat(a?"disabled":"",' style="display: none;">\n                  <div class="form-modal-check-circle ').concat(n?"checked":""," ").concat(a?"form-modal-check-circle-readonly":"",'">\n                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                      <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>\n                      ').concat(n?'<path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>':"","\n                    </svg>\n                  </div>\n                  <span>").concat(t.label||t.value,"</span>\n                </label>\n              ")}):l+='\n              <input type="text" class="form-modal-text-input '.concat(a?"form-modal-text-input-readonly":"",'"\n                     data-question-id="').concat(e.id,'"\n                     value="').concat(e.answer&&"Skipped"!==e.answer?e.answer:"",'"\n                     ').concat(a?"readonly":"",'\n                     placeholder="Enter your answer...">\n            '),l+="\n              </div>\n            </div>\n          "}),l+="</div>",d||0!==t||c||!f||(l+='\n            <div class="form-modal-message-continue">\n              <button class="form-modal-message-continue-btn" id="continue-reading-all-btn">\n                <span class="continue-reading-text">Continue reading</span>\n                <div class="continue-reading-arrow">\n                  <svg width="15" height="15" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                    <path d="M6 9L12 15L18 9" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                  </svg>\n                </div>\n              </button>\n            </div>\n          ')}});var m=c||!f;l+="\n          ".concat(e.readOnly?'\n          <div class="form-modal-readonly-note">\n            <div class="form-modal-readonly-icon">\n              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n                <path d="M12 16V12M12 8H12.01" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n            <div class="form-modal-readonly-content">\n              <p class="form-modal-readonly-title">Read-Only View</p>\n              <p class="form-modal-readonly-text">You can edit your answers in the review step at the end of the application.</p>\n            </div>\n          </div>\n          ':'\n          <div class="form-modal-finish-wrapper" style="'.concat(m?"":"display: none;",'">\n            <button class="form-modal-finish-btn" data-form-id="').concat(e.formId,'">').concat(r?"Save Changes":"Finish","</button>\n          </div>\n          "),"\n        </div>\n      </div>\n    "),o.innerHTML=l,this.shadowRoot.appendChild(o),this.applyTruncationState(o,!c&&f),window.requestAnimationFrame(function(){n.removeLoadingIndicator(150)});var y=o.querySelector(".form-modal-close");if(y&&y.addEventListener("click",function(){n.closeFormModal(e.formId)}),!e.readOnly){var g=o.querySelector(".form-modal-finish-btn");g&&(g.disabled=!1,g.addEventListener("click",function(){n.submitFormModal(e)}))}e.scrollToQuestionId&&setTimeout(function(){var t=o.querySelector('.form-modal-question[data-question-id="'.concat(e.scrollToQuestionId,'"]'));t&&t.scrollIntoView({behavior:"smooth",block:"center"})},300),c||window.requestAnimationFrame(function(){var e=o.querySelector("#continue-reading-all-btn");if(e){var t=!1;e.addEventListener("click",function(s){s.stopPropagation();var i=e.querySelector(".continue-reading-arrow"),a=o.querySelector(".form-modal-finish-btn");t?(n.collapseFormContent(o,e,i,a),t=!1):(n.expandFormContent(o,e,i,a),t=!0)})}}),window.requestAnimationFrame(function(){i&&Array.isArray(i)&&0!==i.length&&i.forEach(function(e){var t=o.querySelector('[data-question-id="'.concat(e.id,'"]'));t&&t.querySelectorAll('input[type="radio"]').forEach(function(e){e.addEventListener("change",function(){if(t.querySelectorAll(".form-modal-check-circle").forEach(function(e){e.classList.remove("checked");var t=e.querySelector("svg");if(t){var n=t.querySelector("path:last-child");n&&"M9 12L11 14L15 10"===n.getAttribute("d")&&n.remove()}}),e.checked){var n=e.closest("label").querySelector(".form-modal-check-circle");if(n){n.classList.add("checked");var o=n.querySelector("svg");if(o){var s=o.querySelector("path:last-child");if(!s||"M9 12L11 14L15 10"!==s.getAttribute("d")){var i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M9 12L11 14L15 10"),i.setAttribute("stroke","currentColor"),i.setAttribute("stroke-width","2"),i.setAttribute("stroke-linecap","round"),i.setAttribute("stroke-linejoin","round"),o.appendChild(i)}}}}})})})}),o.addEventListener("click",function(t){t.target===o&&n.closeFormModal(e.formId)});var w=o.querySelector(".form-modal-container");w&&w.addEventListener("click",function(e){e.stopPropagation()})}},{key:"closeFormModal",value:function(e){var t=this.shadowRoot.querySelector("#form-modal-".concat(e));t&&(this.enableFormModalButtons(t),t.remove(),this.enableReviewButtons(),this.unlockBodyScroll())}},{key:"submitFormModal",value:function(e){var t=this.shadowRoot.querySelector("#form-modal-".concat(e.formId));if(t){var n={},o=e.items.filter(function(e){return"QUESTION"===e.type}),s=!1,i=[];if(o.forEach(function(e){if(e.questionOptions&&e.questionOptions.length>0){var o=t.querySelector('input[name="question_'.concat(e.id,'"]:checked'));o?n[e.id]=o.value:e.required?(i.push(e.question||"This question"),s=!0):n[e.id]="skip"}else{var a=t.querySelector('.form-modal-text-input[data-question-id="'.concat(e.id,'"]'));if(a){var r=a.value.trim();e.required&&!r?(i.push(e.question||"This question"),s=!0):n[e.id]=r||"skip"}else e.required?(i.push(e.question||"This question"),s=!0):n[e.id]="skip"}}),s){this.enableFormModalButtons(t);var a=i.length>0?"Please answer the following required question(s):\n".concat(i.join("\n")):"Please answer all required questions";alert(a)}else{if(0===Object.keys(n).length)return this.enableFormModalButtons(t),void alert("No answers collected. Please try again.");var r={formId:e.formId,formStateKey:e.formStateKey,answers:n,action:"submit_form",isEditMode:e.isEditMode||!1};this.closeFormModal(e.formId),this.sendMessage(JSON.stringify(r))}}else console.error("Modal not found for form:",e.formId)}},{key:"renderFormReview",value:function(e){var t=this;this.currentFormsData=e,this.shadowRoot.querySelectorAll(".form-review-container").forEach(function(e){var t=e.closest(".bubble-container");t?t.remove():e.remove()});var n=e.length,o=e.filter(function(e){return e.completed}).length,s=e.filter(function(e){return e.edited}).length,i='\n      <div class="form-review-container">\n        <div class="form-review-header">\n          <h2>Review Your Application</h2>\n          <div class="form-review-summary">\n            <div class="review-summary-item">\n              <span class="review-summary-label">Forms Completed:</span>\n              <span class="review-summary-value">'.concat(o," of ").concat(n,"</span>\n            </div>\n            ").concat(s>0?'\n            <div class="review-summary-item review-summary-edited">\n              <span class="review-summary-label">Forms Edited:</span>\n              <span class="review-summary-value">'.concat(s,"</span>\n            </div>\n            "):"","\n          </div>\n        </div>\n    ");e.forEach(function(e){var n=t.groupFormItemsByMessage(e.items),o="";n.forEach(function(e){e.questions.length>0&&e.questions.forEach(function(e){var t=e.question||"Question will be here",n=e.answer||"Not answered",s=e.isSkipped||"Skipped"===n||"No answer provided"===n;o+='\n              <div class="form-sidebar-answer-item" data-question-id="'.concat(e.id,'">\n                <div class="form-sidebar-answer-content">\n                  <div class="form-sidebar-answer-label">').concat(t,'</div>\n                  <div class="form-sidebar-answer-value ').concat(s?"form-sidebar-answer-skipped":"",'">').concat(n,"</div>\n                </div>\n              </div>\n            ")})});var s=e.edited?'<div class="form-status-badge form-status-edited"><span>Edited</span></div>':'<div class="form-status-badge form-status-completed"><span>Completed</span></div>',a=e.totalQuestions>0?"".concat(e.answeredQuestions," of ").concat(e.totalQuestions," questions answered"):"All questions answered";i+='\n        <div class="form-sidebar-item form-review-item" data-form-id="'.concat(e.formId,'">\n          <div class="form-sidebar-header">\n            <div class="form-sidebar-icon">\n              <svg width="34" height="34" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n                <path d="M14 2V8H20" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 13H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M16 17H8" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </div>\n            <div class="form-sidebar-title">\n              <div class="form-sidebar-name-row">\n              <div class="form-sidebar-name">').concat(e.formName,"</div>\n                ").concat(s,'\n              </div>\n              <div class="form-sidebar-instruction">').concat(a,'. Click "Edit Form" to make changes.</div>\n            </div>\n          </div>\n          <div class="form-review-edit-section">\n            <button class="form-review-edit-btn" data-form-id="').concat(e.formId,'" title="Edit ').concat(e.formName,'">\n              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                <path d="M11 4H4C3.46957 4 2.96086 4.21071 2.58579 4.58579C2.21071 4.96086 2 5.46957 2 6V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                <path d="M18.5 2.5C18.8978 2.10218 19.4374 1.87868 20 1.87868C20.5626 1.87868 21.1022 2.10218 21.5 2.5C21.8978 2.89782 22.1213 3.43739 22.1213 4C22.1213 4.56261 21.8978 5.10218 21.5 5.5L12 15L8 16L9 12L18.5 2.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n              <span>Edit Form</span>\n            </button>\n          </div>\n          <div class="form-sidebar-answers-container">\n            ').concat(o,"\n          </div>\n        </div>\n      ")}),i+='\n      <div class="review-actions">\n        <div class="review-actions-content">\n          <div class="review-actions-info">\n            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n              <path d="M12 16V12M12 8H12.01" stroke="#6f00ff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n            <span>Review your answers above. Click "Edit Form" on any form to make changes before submitting.</span>\n          </div>\n          <button class="submit-application-btn">\n            <span>Submit Form</span>\n            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n              <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n            </svg>\n          </button>\n        </div>\n      </div>\n    </div>',this.renderMessage(i,!1),this.disableChatInput(),window.requestAnimationFrame(function(){var e=t.shadowRoot.querySelector(".chat-messages .content");if(e){t._reviewClickHandler&&e.removeEventListener("click",t._reviewClickHandler);t._reviewClickHandler=function(e){var n=e.target.closest(".form-review-edit-btn");if(n){var o;if(n.disabled||"0.5"===n.style.opacity)return e.stopPropagation(),void e.preventDefault();e.stopPropagation(),e.preventDefault();var s=n.getAttribute("data-form-id"),i=null===(o=t.currentFormsData)||void 0===o?void 0:o.find(function(e){return e.formId==s});if(i){t.disableReviewButtons();var a=w(w({},i),{},{isEditMode:!0,completed:!0});t.renderFormModal(a)}}else{var r=e.target.closest(".submit-application-btn");if(r){if(r.disabled||"0.5"===r.style.opacity)return e.stopPropagation(),void e.preventDefault();e.stopPropagation(),e.preventDefault(),t.submitApplicationWithEdits()}}},e.addEventListener("click",t._reviewClickHandler)}})}},{key:"startEditingAnswer",value:function(e,t){var n=this,o=this.getQuestionData(e,t);if(o){var s=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(s){var i=s.querySelector(".answer-container");if(i){var a=this.getQuestionOptions(o),r="";if(a&&a.length>0){var l=o.required||!1;r='\n                  <div class="edit-answer-container">\n                    <select class="edit-answer-select" data-question-id="'.concat(e,'">\n                      <option value="">Select an answer...</option>\n                      ').concat(l?"":'<option value="skip">Skip this question</option>',"\n                      ").concat(a.map(function(e){var t=o.answer===e.label||o.answer===e.value;return'<option value="'.concat(e.value,'" ').concat(t?"selected":"",">").concat(e.label,"</option>")}).join(""),'\n                    </select>\n                    <div class="edit-actions">\n                      <button class="save-answer-btn" data-question-id="').concat(e,'">Save</button>\n                      <button class="cancel-edit-btn" data-question-id="').concat(e,'">Cancel</button>\n                    </div>\n                  </div>\n                ')}else{var c=o.required||!1;r='\n                  <div class="edit-answer-container">\n                    <textarea class="edit-answer-textarea" data-question-id="'.concat(e,'" placeholder="Enter your answer...">').concat("Skipped"===o.answer||"No answer provided"===o.answer?"":o.answer,'</textarea>\n                    <div class="edit-actions">\n                      <button class="save-answer-btn" data-question-id="').concat(e,'">Save</button>\n                      <button class="cancel-edit-btn" data-question-id="').concat(e,'">Cancel</button>\n                      ').concat(c?"":'<button class="skip-answer-btn" data-question-id="'.concat(e,'">Skip</button>'),"\n                    </div>\n                  </div>\n                ")}i.innerHTML=r;var d=i.querySelector(".save-answer-btn"),u=i.querySelector(".cancel-edit-btn"),p=i.querySelector(".skip-answer-btn");d&&d.addEventListener("click",function(o){n.saveEditedAnswer(e,t)}),u&&u.addEventListener("click",function(o){n.cancelEditAnswer(e,t)}),p&&p.addEventListener("click",function(o){n.skipEditedAnswer(e,t)})}else console.error("Answer container not found")}else console.error("Question element not found for ID:",e)}else console.error("Question data not found for ID:",e)}},{key:"getQuestionData",value:function(e,t){var n,o=m(t);try{for(o.s();!(n=o.n()).done;){var s,i=m(n.value.items);try{for(i.s();!(s=i.n()).done;){var a=s.value;if("QUESTION"===a.type&&a.id==e)return a}}catch(e){i.e(e)}finally{i.f()}}}catch(e){o.e(e)}finally{o.f()}return null}},{key:"getQuestionOptions",value:function(e){return e.questionOptions&&e.questionOptions.length>0?e.questionOptions.filter(function(e){return"Select"!==e.value&&"Select"!==e.label&&"-1"!==e.value&&"-1"!==e.label}).map(function(e){return{value:e.value||e.label,label:e.label||e.value}}):null}},{key:"saveEditedAnswer",value:function(e,t){var n=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(n){var o=n.querySelector(".edit-answer-container");if(o){var s="",i=o.querySelector(".edit-answer-select"),a=o.querySelector(".edit-answer-textarea");if(i?s=i.value:a&&(s=a.value.trim()),s){var r,l=m(t);try{for(l.s();!(r=l.n()).done;){var c,d=m(r.value.items);try{for(d.s();!(c=d.n()).done;){var u=c.value;if("QUESTION"===u.type&&u.id==e){u.answer="skip"===s?"Skipped":s,u.isSkipped="skip"===s;break}}}catch(e){d.e(e)}finally{d.f()}}}catch(e){l.e(e)}finally{l.f()}this.storeEditedAnswer(e,s),this.renderAnswerDisplay(n,"skip"===s?"Skipped":s,"skip"===s)}else alert('Please provide an answer or select "Skip this question"')}}}},{key:"skipEditedAnswer",value:function(e,t){this.saveEditedAnswer(e,t,"skip")}},{key:"cancelEditAnswer",value:function(e,t){var n=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(n){var o,s="",i=m(t);try{for(i.s();!(o=i.n()).done;){var a,r=m(o.value.items);try{for(r.s();!(a=r.n()).done;){var l=a.value;if("QUESTION"===l.type&&l.id==e){s=l.answer;break}}}catch(e){r.e(e)}finally{r.f()}}}catch(e){i.e(e)}finally{i.f()}this.renderAnswerDisplay(n,s,"Skipped"===s)}}},{key:"renderAnswerDisplay",value:function(e,t,n){var o=this,s=e.querySelector(".answer-container");if(s){var i=n?"answer-text skipped":"answer-text";s.innerHTML='\n                <div class="'.concat(i,'">').concat(t,'</div>\n                <button class="edit-answer-btn" data-question-id="').concat(e.getAttribute("data-question-id"),'">Edit</button>\n              ');var a=s.querySelector(".edit-answer-btn");a&&a.addEventListener("click",function(e){var t=e.target.getAttribute("data-question-id");o.startEditingAnswer(t,o.currentFormsData)})}}},{key:"storeEditedAnswer",value:function(e,t){this.editedAnswers||(this.editedAnswers={}),this.editedAnswers[e]=t}},{key:"submitApplicationWithEdits",value:function(){this.disableReviewButtons();var e=[{review_confirmed:!0,editedAnswers:this.editedAnswers||{}}];this.sendMessage(JSON.stringify(e))}},{key:"disableReviewButtons",value:function(){var e=this.shadowRoot.querySelector(".form-review-container");if(e){var t=e.querySelectorAll(".form-review-edit-btn"),n=e.querySelector(".submit-application-btn");if(t.forEach(function(e){var t=e.disabled||e.hasAttribute("disabled");e.setAttribute("data-originally-disabled",t?"true":"false"),e.disabled=!0,e.style.opacity="0.5",e.style.cursor="not-allowed"}),n){var o=n.disabled||n.hasAttribute("disabled");n.setAttribute("data-originally-disabled",o?"true":"false"),n.disabled=!0,n.style.opacity="0.5",n.style.cursor="not-allowed"}}}},{key:"enableReviewButtons",value:function(){var e=this.shadowRoot.querySelector(".form-review-container");if(e){var t=e.querySelectorAll(".form-review-edit-btn"),n=e.querySelector(".submit-application-btn");if(t.forEach(function(e){"true"===e.getAttribute("data-originally-disabled")?(e.style.opacity="",e.style.cursor=""):(e.disabled=!1,e.removeAttribute("disabled"),e.style.opacity="1",e.style.cursor="pointer"),e.removeAttribute("data-originally-disabled")}),n)"true"===n.getAttribute("data-originally-disabled")?(n.style.opacity="",n.style.cursor=""):(n.disabled=!1,n.removeAttribute("disabled"),n.style.opacity="1",n.style.cursor="pointer"),n.removeAttribute("data-originally-disabled")}}},{key:"disableFormModalButtons",value:function(e){if(e){var t=e.querySelector(".form-modal-finish-btn"),n=e.querySelector(".form-modal-close");t&&(t.disabled=!0,t.style.opacity="0.5",t.style.cursor="not-allowed",t.setAttribute("data-originally-disabled",t.hasAttribute("disabled")?"true":"false")),n&&(n.disabled=!0,n.style.opacity="0.5",n.style.cursor="not-allowed",n.setAttribute("data-originally-disabled",n.hasAttribute("disabled")?"true":"false"))}}},{key:"enableFormModalButtons",value:function(e){if(e){var t=e.querySelector(".form-modal-finish-btn"),n=e.querySelector(".form-modal-close");if(t)"true"===t.getAttribute("data-originally-disabled")||(t.disabled=!1,t.style.opacity="1",t.style.cursor="pointer"),t.removeAttribute("data-originally-disabled");if(n)"true"===n.getAttribute("data-originally-disabled")||(n.disabled=!1,n.style.opacity="1",n.style.cursor="pointer"),n.removeAttribute("data-originally-disabled")}}},{key:"showFormEditSuccess",value:function(e){var t='‚úì Changes to "'.concat(e||"form",'" have been saved successfully'),n=document.createElement("div");if(n.className="form-edit-success-message",n.textContent=t,n.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: #10B981;\n      color: white;\n      padding: 12px 20px;\n      border-radius: 8px;\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n      z-index: 10000;\n      font-size: 14px;\n      font-weight: 500;\n      animation: slideIn 0.3s ease-out;\n    ",!document.getElementById("form-edit-success-styles")){var o=document.createElement("style");o.id="form-edit-success-styles",o.textContent="\n        @keyframes slideIn {\n          from {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n          to {\n            transform: translateX(0);\n            opacity: 1;\n          }\n        }\n        @keyframes slideOut {\n          from {\n            transform: translateX(0);\n            opacity: 1;\n          }\n          to {\n            transform: translateX(100%);\n            opacity: 0;\n          }\n        }\n      ",document.head.appendChild(o)}(this.shadowRoot||document.body).appendChild(n),setTimeout(function(){n.style.animation="slideOut 0.3s ease-out",setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n)},300)},3e3)}},{key:"formatResumeAnswer",value:function(e,t){var n,o=String(e||"").replace(/"/g,"&quot;"),s=t||(null==e||null===(n=e.split("/").pop())||void 0===n?void 0:n.split("?")[0])||"Resume.pdf";s=function(e){if(!e)return"";var t=document.createElement("div");return t.textContent=String(e),t.innerHTML}(s);return'<div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef; max-width: 100%;">\n      <div style="font-size: 32px; flex-shrink: 0;">'.concat("üìÑ",'</div>\n      <div style="flex: 1; min-width: 0;">\n        <div style="font-weight: 600; color: #212529; margin-bottom: 4px; word-break: break-word;">').concat(s,'</div>\n        <div style="font-size: 12px; color: #6c757d;">Resume uploaded successfully</div>\n      </div>\n      <a href="').concat(o,'" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 6px; padding: 8px 16px; background: #6f00ff; color: white; text-decoration: none; border-radius: 6px; font-size: 14px; font-weight: 500; white-space: nowrap; transition: background 0.2s;">\n        <svg style="stroke:#fff !important" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>\n          <polyline points="7 10 12 15 17 10"></polyline>\n          <line x1="12" y1="15" x2="12" y2="3"></line>\n        </svg>\n        View\n      </a>\n    </div>')}},{key:"hideResumeUploadForms",value:function(){this.shadowRoot.querySelectorAll(".chat-messages form").forEach(function(e){if(e.querySelector('input[type="file"]')){var t=e.querySelector("label"),n=e.textContent||"",o=e.innerHTML||"";if(n.toLowerCase().includes("resume")||n.includes("%{resume_upload_link}")||o.includes("resume_upload")||t&&(t.textContent.toLowerCase().includes("resume")||t.textContent.includes("%{resume_upload_link}"))){var s=e.closest(".bubble-container");s?s.style.display="none":e.style.display="none"}}})}},{key:"checkAndHideResumeUploadForms",value:function(){var e=this.shadowRoot.querySelectorAll(".chat-messages .bubble-container"),t=!1;e.forEach(function(e){var n=e.textContent||"",o=e.innerHTML||"";(n.includes("storage.googleapis.com")||n.includes("file-upload/resume/")||n.includes("/resume/")||o.includes("Resume uploaded successfully")||e.querySelector('a[href*="resume"]')||e.querySelector('a[href*="storage.googleapis.com"]'))&&(t=!0)}),t&&this.hideResumeUploadForms()}}],[{key:"observedAttributes",get:function(){return["data-base-url","data-use-grey-loader"]}}]),t}(window.HTMLElement);window.customElements.get("dalia-apply-web")||window.customElements.define("dalia-apply-web",q),window.customElements.get("dalia-apply-hosted")||window.customElements.define("dalia-apply-hosted",q)},50783:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(15861),s=n(15671),i=n(43144),a=n(64687),r=n.n(a),l=(n(96869),n(278),n(60228),n(73964),n(64043),function(){function e(){(0,s.Z)(this,e)}var t;return(0,i.Z)(e,null,[{key:"debounce",value:function(e){var t,n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];clearTimeout(t),t=setTimeout(function(){e.apply(n,i)},o)}}},{key:"isMobile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:760;return window&&window.innerWidth<e}},{key:"dotPath",value:function(e,t){return t.split(".").reduce(function(e,t){return e&&e[t]},e)}},{key:"sleep",value:(t=(0,o.Z)(r().mark(function e(t){return r().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},{key:"syncViewportHeightForIOS",value:function(e){if(!(e instanceof HTMLElement))throw new Error("syncViewportHeight: element parameter must be an HTMLElement");if(!(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream))return function(){};var t=o(),n=null;function o(){return window.visualViewport?window.visualViewport.height:window.innerHeight}function s(){var t=function(){for(var e=document.activeElement||null;e&&e.shadowRoot&&e.shadowRoot.activeElement;)e=e.shadowRoot.activeElement;return e}()||e;try{t.scrollIntoView({block:"center",inline:"nearest"})}catch(e){t.scrollIntoView()}}function i(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=o();e.style.height="".concat(i,"px !important"),n&&i<t-8&&requestAnimationFrame(function(){setTimeout(function(){window.scrollTo(0,1),setTimeout(function(){s()},30)},0)}),t=i}i(!1);var a=function(){n&&clearTimeout(n),n=window.setTimeout(function(){return i(!0)},100)};window.visualViewport?window.visualViewport.addEventListener("resize",a):window.addEventListener("resize",a);var r=function(){window.scrollTo(0,0)};return window.addEventListener("touchend",r,{passive:!0}),function(){window.visualViewport?window.visualViewport.removeEventListener("resize",a):window.removeEventListener("resize",a),window.removeEventListener("touchend",r),n&&(clearTimeout(n),n=null),e.style.height=""}}}]),e}())},88820:(e,t,n)=>{var o=n(10509),s=n(90690),i=n(94413),a=n(6310),r=TypeError,l=function(e){return function(t,n,l,c){var d=s(t),u=i(d),p=a(d);o(n);var h=e?p-1:0,f=e?-1:1;if(l<2)for(;;){if(h in u){c=u[h],h+=f;break}if(h+=f,e?h<0:p<=h)throw new r("Reduce of empty array with no initial value")}for(;e?h>=0:p>h;h+=f)h in u&&(c=n(c,u[h],h,d));return c}};e.exports={left:l(!1),right:l(!0)}},278:(e,t,n)=>{var o=n(79989),s=n(88820).left,i=n(16834),a=n(3615);o({target:"Array",proto:!0,forced:!n(50806)&&a>79&&a<83||!i("reduce")},{reduce:function(e){var t=arguments.length;return s(this,e,t,t>1?arguments[1]:void 0)}})}}]);