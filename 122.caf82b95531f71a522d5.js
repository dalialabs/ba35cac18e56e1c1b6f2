"use strict";(self.webpackChunkmaia_node=self.webpackChunkmaia_node||[]).push([[122],{47122:(e,t,n)=>{n.r(t);n(2259),n(62010),n(67945),n(84185),n(83851),n(81278),n(60825);var s=n(80296),a=n(82284),i=n(45458),o=n(10467),r=n(64467),c=n(23029),l=n(92901),d=n(50388),u=n(53954),p=n(15361),h=n(54756),v=n.n(h);n(52675),n(89463),n(28706),n(2008),n(50113),n(51629),n(23418),n(74423),n(25276),n(64346),n(23792),n(48598),n(8921),n(62062),n(34782),n(15086),n(26910),n(59089),n(60739),n(23288),n(94170),n(5506),n(79432),n(26099),n(3362),n(84864),n(27495),n(38781),n(99449),n(21699),n(47764),n(25440),n(90744),n(11392),n(42762),n(12041),n(23500),n(62953),n(76031),n(3296),n(27208),n(48408);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var s=0,a=function(){};return{s:a,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){r=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(r)throw i}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=Array(t);n<t;n++)s[n]=e[n];return s}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,s)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}var w="dalia-apply-token",k={baseUrl:"http://dashboard.dalia.localhost:3000",submitPath:"api/v2/eapply/web",messagesPath:"eapply/web-messages",customCssPath:"",completeMessage:"You have completed the application questions successfully",blackListMessagesContains:["Reminder"],customCss:"",isApplyThree:!1,hideBackBtn:!0},C=["Enter","NumpadEnter"],S="api",A=function(e){function t(){var e,n,s,a;return(0,c.A)(this,t),n=this,s=t,s=(0,u.A)(s),e=(0,d.A)(n,g()?Reflect.construct(s,a||[],(0,u.A)(n).constructor):s.apply(n,a)),console.log("Loading dalia apply web..."),e.attachShadow({mode:"open"}),e}return(0,p.A)(t,e),(0,l.A)(t,[{key:"connectedCallback",value:function(){this.options=b(b({},k),this.dataset),this.isAPICrawler=this.options.crawler===S,this.options.startMinimized=this.options.startMinimized&&"true"===this.options.startMinimized,this.data={};try{this.jobDetails=JSON.parse(this.options.jobDetails)}catch(e){console.log(e)}this.render()}},{key:"getUserToken",value:function(){var e=this.dataset.applyToken;if(e)return this.insideForm="form"===this.options.source,this.insideRVP="rvp"===this.options.source,this.applyInForm=this.insideForm||this.insideRVP,e;var t=new URL(window.location.href);return t.searchParams.has(w)?t.searchParams.get(w):null}},{key:"getSearchParam",value:function(e){var t=new URL(window.location.href);return t.searchParams.has(e)?t.searchParams.get(e):null}},{key:"waitForStyleSheetLoading",value:function(){var e=this.shadowRoot.querySelectorAll('link[as="style"]');return Promise.all(Array.from(e).map(function(e){return new Promise(function(t){e.sheet?t():(e.addEventListener("load",function(){t()}),e.onerror=t)})}))}},{key:"getInitialMessage",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new"){case"new":case"started":return"Hi".concat(this.options.userName?" ".concat(this.options.userName):"","!\n        Thanks for your interest in the <strong>").concat(this.options.jobTitle,"</strong> role in ").concat(this.options.jobLocation,".\n        Please answer the questions below to complete your application.")}}},{key:"canRender",value:function(){return null!==this.getUserToken()}},{key:"render",value:(h=(0,o.A)(v().mark(function e(){var t,s,a,i,o,r,c,l=this;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canRender()){e.next=1;break}return e.abrupt("return");case 1:if(e.prev=1,!this.isAPICrawler){e.next=2;break}return this.prepareAPICrawlerSubmit(),this.loadMessages(),e.abrupt("return");case 2:return e.next=3,window.fetch("".concat(this.options.baseUrl,"/html/apply-web.html"));case 3:return t=e.sent,e.next=4,t.text();case 4:return s=e.sent,(a=document.createElement("template")).innerHTML=s,e.next=5,n.e(625).then(n.bind(n,61625));case 5:return i=e.sent.default.toString(),this.shadowRoot.innerHTML+="<style>".concat(i,"</style>"),this.options.customCss&&""!==this.options.customCss&&(this.shadowRoot.innerHTML+='<link rel="stylesheet" as="style" href="'.concat(this.options.customCss,'">')),this.options.customCssPath&&""!==this.options.customCssPath&&(this.shadowRoot.innerHTML+='<link rel="stylesheet" as="style" href="'.concat(this.options.customCssPath,'">')),e.next=6,this.waitForStyleSheetLoading();case 6:this.dispatchEvent(new Event("apply-component-loaded")),this.shadowRoot.appendChild(a.content.cloneNode(!0)),this.prepareSelectors(),(o="true"===this.options.showJobDetails&&this.getJobDetailsElement(this.jobDetails))&&(this.eApplyPopUp.appendChild(o),this.eApplyPopUpContent.classList.add("hide"),o.querySelectorAll(".apply-btn").forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),l.loadMessages(),o.classList.add("hide"),l.eApplyPopUpContent.classList.remove("hide"),l.dispatchEvent(new Event("application-started"))})})),this.renderJobTitle(),this.toggleViewModal(),this.sendMessageEvents(),this.updateDocumentRoot(),this.options.userName&&(r=this.getInitialMessage(this.options.applicationStatus),this.renderMessage(r,!1,this.options.applicationStatus)),this.renderLoadingImage(),"true"!==this.options.showJobDetails&&this.loadMessages(),this.handleResize(),this.applyInForm&&!this.options.startMinimized&&this.applyWebContainer.classList.add("popup-opened"),this.options.startMinimized?this.minimizePopUp():this.continueAplyingContainer.click(),e.next=8;break;case 7:e.prev=7,c=e.catch(1),console.error(c);case 8:case"end":return e.stop()}},e,this,[[1,7]])})),function(){return h.apply(this,arguments)})},{key:"getJobTags",value:function(e){var t=e||{},n=t.city,s=t.state,a=t.pay_rate,i=t.type,o=[n,s].filter(Boolean).join(",");return'\n          <div class="job-tags">\n            '.concat(o&&'<span class="job-tag" >'.concat(o,"</span>"),"\n            ").concat(a&&'<span class="job-tag" >'.concat(a,"</span>"),"\n            ").concat(i&&'<span class="job-tag" >'.concat(i,"</span>"),"\n          </div>\n    ")}},{key:"decodeHTML",value:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}},{key:"getJobDetailsElement",value:function(e){var t;if(e){var n=document.createElement("div");return n.setAttribute("id","job-details"),n.innerHTML='\n      <div class="jobs-container-sm job-container">\n        <div class="d-flex justify-content-between flex-column flex-md-row gap-1 sticky-top header">\n          <div class="d-flex flex-column align-items-start job-title-container">\n              <div class="d-flex align-items-baseline flex-column info">\n                <div class="d-flex mb-2 align-items-center">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                    <path d="M15 4.375H13.9583V3.33333C13.9583 2.52917 13.3042 1.875 12.5 1.875H7.5C6.69583 1.875 6.04167 2.52917 6.04167 3.33333V4.375H5C2.985 4.375 1.875 5.485 1.875 7.5V7.59918V9.37754V15C1.875 17.015 2.985 18.125 5 18.125H15C17.015 18.125 18.125 17.015 18.125 15V9.37754V7.59918V7.5C18.125 5.485 17.015 4.375 15 4.375ZM7.29167 3.33333C7.29167 3.21833 7.385 3.125 7.5 3.125H12.5C12.615 3.125 12.7083 3.21833 12.7083 3.33333V4.375H7.29167V3.33333ZM3.125 7.5C3.125 6.18583 3.68583 5.625 5 5.625H15C16.3142 5.625 16.875 6.18583 16.875 7.5V7.59918V9.37754C16.875 9.62838 16.7325 9.84745 16.5033 9.94995C15.7825 10.2716 14.5542 10.73 12.7983 11.0884C12.7125 11.1059 12.62 11.04 12.57 10.9667C11.9658 10.0642 11.0058 9.52586 10 9.52586C8.99417 9.52586 8.03417 10.0642 7.43 10.9667C7.38083 11.0409 7.29167 11.1075 7.20166 11.0884C5.44667 10.73 4.2175 10.2716 3.49667 9.94995C3.2675 9.84745 3.125 9.62838 3.125 9.37754V7.59918V7.5ZM15 16.875H5C3.68583 16.875 3.125 16.3142 3.125 15V11.15C3.91667 11.4925 5.18584 11.9517 6.95084 12.3125C7.52584 12.4292 8.12417 12.175 8.46834 11.6609C8.84 11.1059 9.4125 10.775 10 10.775C10.5875 10.775 11.16 11.1059 11.5308 11.6609C11.8192 12.0917 12.2842 12.3408 12.7667 12.3408C12.86 12.3408 12.9542 12.3317 13.0475 12.3125C14.8133 11.9517 16.0825 11.4925 16.8742 11.15V15C16.875 16.3142 16.3142 16.875 15 16.875ZM10.85 12.5C10.85 12.96 10.4767 13.3333 10.0167 13.3333C9.55667 13.3333 9.17917 12.96 9.17917 12.5C9.17917 12.04 9.5475 11.6667 10.0083 11.6667H10.0167C10.4767 11.6667 10.85 12.04 10.85 12.5Z" fill="currentColor"/>\n                  </svg>\n                  <span class="job-title ms-2">'.concat(e.title,"</span>\n                </div>\n                ").concat(e["tags.company"]?'<div class="d-flex mb-2 align-items-center">\n                   <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">\n                      <path d="M16.6675 7.6217L13.9583 7.00178V5.67345C13.9583 4.79512 13.3608 4.04417 12.505 3.84667L4.17165 1.92345C3.61165 1.79429 3.03331 1.92502 2.58331 2.28336C2.13331 2.64169 1.875 3.17585 1.875 3.75085V15.8342C1.875 17.2908 2.71 18.1258 4.16667 18.1258H15.8333C17.29 18.1258 18.125 17.2908 18.125 15.8342V9.45011C18.125 8.57011 17.5258 7.81753 16.6675 7.6217ZM3.125 15.8334V3.75003C3.125 3.55837 3.21163 3.3801 3.3608 3.26094C3.4733 3.17177 3.60921 3.12503 3.74837 3.12503C3.79587 3.12503 3.84331 3.13005 3.88997 3.14172L12.2233 5.06493C12.5091 5.13077 12.7083 5.38095 12.7083 5.67345V7.50003V16.875H10.2083V14.1667C10.2083 12.9025 9.18083 11.875 7.91667 11.875C6.6525 11.875 5.625 12.9025 5.625 14.1667V16.875H4.16667C3.3975 16.875 3.125 16.6025 3.125 15.8334ZM8.95833 16.875H6.875V14.1667C6.875 13.5925 7.3425 13.125 7.91667 13.125C8.49083 13.125 8.95833 13.5925 8.95833 14.1667V16.875ZM16.875 15.8334C16.875 16.6025 16.6025 16.875 15.8333 16.875H13.9583V8.28413L16.3892 8.83996C16.675 8.90579 16.875 9.15596 16.875 9.44929V15.8334ZM8.54167 7.50003C8.54167 7.15503 8.82167 6.87503 9.16667 6.87503H10C10.345 6.87503 10.625 7.15503 10.625 7.50003C10.625 7.84503 10.345 8.12503 10 8.12503H9.16667C8.82167 8.12503 8.54167 7.84503 8.54167 7.50003ZM5.20833 7.50003C5.20833 7.15503 5.48833 6.87503 5.83333 6.87503H6.66667C7.01167 6.87503 7.29167 7.15503 7.29167 7.50003C7.29167 7.84503 7.01167 8.12503 6.66667 8.12503H5.83333C5.48833 8.12503 5.20833 7.84503 5.20833 7.50003ZM8.54167 10C8.54167 9.65503 8.82167 9.37503 9.16667 9.37503H10C10.345 9.37503 10.625 9.65503 10.625 10C10.625 10.345 10.345 10.625 10 10.625H9.16667C8.82167 10.625 8.54167 10.345 8.54167 10ZM5.20833 10C5.20833 9.65503 5.48833 9.37503 5.83333 9.37503H6.66667C7.01167 9.37503 7.29167 9.65503 7.29167 10C7.29167 10.345 7.01167 10.625 6.66667 10.625H5.83333C5.48833 10.625 5.20833 10.345 5.20833 10Z" fill="currentColor"/>\n                    </svg>\n                      <span class="ms-2">'.concat(e["tags.company"],"</span>\n                     </div>"):"",'\n              </div>\n          </div>\n          <div class="d-flex apply-container">\n              <a class="apply-btn btn btn-primary action-btn rounded-pill mt-3 hide-mobile" href="#" target="_blank">Apply</a>\n          </div>\n        </div>\n        ').concat(this.getJobTags(e),'\n        <h4>Job Description</h4>\n        <div class="inner-container pb-3 pt-md-3">\n          <div class="job-description">\n              <p>\n                ').concat(this.decodeHTML(null===(t=e.description)||void 0===t?void 0:t.replace(/\[+[^\]]*]+/g,"")),'\n              </p>\n          </div>\n          <div class="apply-btn-container">\n            <a class="apply-btn btn btn-primary action-btn rounded-pill my-5 text-uppercase d-none d-md-flex" href="#" target="_blank">Apply Now</a>\n          </div>\n      </div>\n    '),n}}},{key:"updateQuickApplyBtn",value:function(){document.querySelectorAll(".quick-apply-btn").forEach(function(e){e&&(e.innerText="Applied",e.disabled=!0,e.style.borderRadius="12px !important",e.classList.replace("btn-success","btn-secondary"),document.querySelectorAll(".animated-button span").forEach(function(e){e.style.animation="none"}))})}},{key:"prepareAPICrawlerSubmit",value:function(){var e=this,t=document.querySelector(".confirm-apply-btn");document.querySelectorAll(".quick-apply-btn").forEach(function(e){e.innerText="Quick Apply"}),t.addEventListener("click",function(){e.sendMessage("yes"),e.updateQuickApplyBtn()})}},{key:"handleResize",value:function(){var e=this,t=!1;this.chatInput.addEventListener("focus",function(){t=!0}),this.chatInput.addEventListener("focusout",function(){t=!1});var n=window.visualViewport.height;window.visualViewport.addEventListener("resize",function(){e.applyWebContainer.classList.contains("popup-opened")&&(t&&window.visualViewport.height<n?(e.insideForm||e.insideRVP||(e.applyWebContainer.style.height="".concat(window.visualViewport.height,"px")),e.shadowRoot.querySelector(".chat-messages .content").scrollTo(0,e.shadowRoot.querySelector(".chat-messages .content").scrollHeight)):e.insideForm||e.insideRVP||e.applyWebContainer.removeAttribute("style"))})}},{key:"updateDocumentRoot",value:function(){var e=this,t=document.querySelectorAll(".apply-btn");t.length>0&&t.forEach(function(t){t.removeAttribute("href"),t.removeAttribute("target"),t.addEventListener("click",function(){e.applyWebContainer.classList.add("popup-opened"),e.getSearchParam("submit-application")&&e.sendMessage("yes")})})}},{key:"renderMessages",value:function(e){var t=this;e.applyApplication&&(e=this.data=b(b({},e),this.reformatApply3Data(e))),this.shadowRoot.querySelector(".bubble-container.loading-message").remove(),e.messages.forEach(function(n){t.renderMessage(n.options.content,"user"===n.initiator,e.appUserStatus)});var n=this.shadowRoot.querySelector(".chat-messages .content");n&&n.scrollTo(0,n.scrollHeight)}},{key:"isQuestionAnswered",value:function(e){var t=e||{},n=t.answer,s=t.answers;return!(!n&&!s)&&[n].concat((0,i.A)(s)).some(function(e){return e&&"incoming"===e.type})}},{key:"reformatApply3Data",value:function(e){var t,n,s=this,a=[],i=y(null===(t=e.applyApplication.operations)||void 0===t?void 0:t.filter(function(e){var t;return null===(t=e.question)||void 0===t?void 0:t.parsedText}));try{var o=function(){var e,t,i,o=n.value;(o.question&&a.push({options:{content:s.isQuestionAnswered(o)?o.question.originalText:o.question.parsedText},initiator:"system"}),o.answer&&"outgoing_error"!==o.answer.type)&&a.push({options:{content:(null===(t=o.question)||void 0===t||null===(t=t.options)||void 0===t||null===(i=t.find)||void 0===i||null===(i=i.call(t,function(e){return e.value===o.answer.parsedText}))||void 0===i?void 0:i.text)||o.answer.originalText},initiator:"user"});if((null===(e=o.answers)||void 0===e?void 0:e.length)>0){var r,c=y(o.answers);try{var l=function(){var e,t,n=r.value;"incoming"===n.type&&a.push({options:{content:(null===(e=o.question)||void 0===e||null===(e=e.options)||void 0===e||null===(t=e.find)||void 0===t||null===(t=t.call(e,function(e){return e.value===n.parsedText}))||void 0===t?void 0:t.text)||n.originalText},initiator:"user"})};for(c.s();!(r=c.n()).done;)l()}catch(e){c.e(e)}finally{c.f()}}};for(i.s();!(n=i.n()).done;)o()}catch(e){i.e(e)}finally{i.f()}return{messages:a,appUserStatus:e.applyApplication.status}}},{key:"loadMessages",value:function(){var e=this;window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.messagesPath),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken(),runAlgorithm:this.applyInForm,source:this.options.source})}).then(function(e){return e.json()}).then(function(t){var n,s;(e.token=t.token,t.applyApplication&&(t=e.data=b(b({},t),e.reformatApply3Data(t))),e.isUserApplied(t.appUserStatus))?e.isAPICrawler?e.updateQuickApplyBtn():e.handleSubmissionComplete(t.appUserStatus,null===(s=t)||void 0===s?void 0:s.message):e.isAPICrawler||(e.renderMessages(t),e.checkForPendingFormReview());!e.applyInForm&&(e.options.isApplyThree||!(null!==(n=t.messages)&&void 0!==n&&n.length)||t.messages[t.messages.length-1]&&"system"!==t.messages[t.messages.length-1].initiator)&&e.sendMessage("SIGNAL_APPLY")})}},{key:"checkForPendingFormReview",value:(r=(0,o.A)(v().mark(function e(){var t,n,s;return v().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",headers:{"x-api-token":this.token,"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken(),answer:"",userClickedApplyWebButton:!0})});case 1:return t=e.sent,e.next=2,t.json();case 2:if("FORM_REVIEW"!==(n=e.sent).type){e.next=3;break}return this.renderSimpleFormReview(n.formsData),e.abrupt("return",!0);case 3:return e.abrupt("return",!1);case 4:return e.prev=4,s=e.catch(0),console.log("Error checking for pending form review:",s),e.abrupt("return",!1);case 5:case"end":return e.stop()}},e,this,[[0,4]])})),function(){return r.apply(this,arguments)})},{key:"renderJobTitle",value:function(){var e=this;this.shadowRoot.querySelectorAll(".job-title").forEach(function(t){var n,s=e.options.jobTitle||(null===(n=document.querySelector(".job-title"))||void 0===n?void 0:n.innerText)||document.querySelector("title").innerText.split("|")[0].trim();t.innerText="".concat(s),t.setAttribute("data-tooltip",s)}),this.shadowRoot.querySelectorAll(".client-name").forEach(function(t){var n;t.innerText=e.options.clientName||(null===(n=document.querySelector(".client-name"))||void 0===n?void 0:n.innerText)||document.querySelector("title").innerText.split("|")[1].trim()})}},{key:"prepareSelectors",value:function(){var e=this;this.applyWebContainer=this.shadowRoot.querySelector(".eapply-web-container"),this.options.source&&this.applyWebContainer.setAttribute("data-container-type",this.options.source),this.chatInput=this.shadowRoot.querySelector(".chat-input"),this.chatInputContainer=this.shadowRoot.querySelector(".chat-controls"),this.options.placeHolder&&this.chatInput.setAttribute("placeholder",this.options.placeHolder),this.applyButton=this.shadowRoot.querySelector(".apply-now"),this.sendButton=this.shadowRoot.querySelector(".btn-send"),this.chatLoader=this.shadowRoot.querySelector(".chat-messages > .loader"),this.backButton=this.shadowRoot.querySelector(".popup-header .back-btn"),this.eApplyPopUp=this.shadowRoot.querySelector(".eapply-popup"),this.eApplyPopUpContent=this.shadowRoot.querySelector(".eapply-popup .popup-content"),this.jobsCount=this.shadowRoot.querySelector("#jobs-count"),this.jobsCount&&(this.jobsCount.innerText=this.options.jobsCount||3),this.backButton&&this.backButton.addEventListener("click",function(){var t;e.dispatchEvent(new Event(e.isUserApplied(null===(t=e.data)||void 0===t?void 0:t.appUserStatus)?"submitted":"back-btn-clicked",{bubbles:!1}))}),this.minimizeButton=this.shadowRoot.querySelector(".close-popup"),this.continueAplyingContainer=this.shadowRoot.querySelector("#continue-applying-container"),this.continueAplyingContainer&&this.continueAplyingContainer.addEventListener("click",function(){e.dispatchEvent(new Event("popup-opened"),{bubbles:!1}),e.continueAplyingContainer.classList.add("hide"),e.eApplyPopUp.classList.remove("hide"),e.applyWebContainer.classList.add("popup-opened")}),this.options.hideBackBtn||this.backButton.classList.remove("hide")}},{key:"closePopUp",value:function(){this.applyWebContainer.classList.remove("popup-opened"),this.applyWebContainer.removeAttribute("style")}},{key:"minimizePopUp",value:function(){this.eApplyPopUp.classList.add("hide"),this.continueAplyingContainer.classList.remove("hide")}},{key:"toggleViewModal",value:function(){var e=this;this.applyButton.addEventListener("click",function(){e.applyWebContainer.classList.add("popup-opened")}),this.shadowRoot.querySelectorAll(".completed .eapply-btn").forEach(function(t){t.addEventListener("click",function(){e.insideForm||e.insideRVP?e.dispatchEvent(new Event("submitted",{bubbles:!1})):e.closePopUp()})}),this.shadowRoot.querySelectorAll(".close-popup").forEach(function(t){t.addEventListener("click",function(){e.minimizePopUp(),e.dispatchEvent(new Event("popup-closed",{bubbles:!1}))})})}},{key:"sendMessageEvents",value:function(){var e=this;this.chatInput.addEventListener("keydown",function(t){C.includes(t.code)&&e.updateMessageFormAndSendMessage(t.target.value)}),this.sendButton.addEventListener("click",function(){e.updateMessageFormAndSendMessage(e.chatInput.value)})}},{key:"sendMessage",value:function(e){var t=this;e&&(this.renderLoadingImage(),window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",headers:{"x-api-token":this.token,"Content-Type":"application/json"},body:JSON.stringify({daliaApplyToken:this.getUserToken(),answer:e,userClickedApplyWebButton:!0,source:this.options.source})}).then(function(e){return e.json()}).then(function(e){t.chatLoader.classList.remove("show"),t.data.appUserStatus=e.appUserStatus,"FORM_REVIEW"!==e.type?(t.renderMessage(e.message,!1,e.appUserStatus),e.message.includes("<form>")||(t.chatInput.removeAttribute("disabled"),t.sendButton.removeAttribute("disabled"),t.chatInput.focus())):t.renderSimpleFormReview(e.formsData)}))}},{key:"updateMessageFormAndSendMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){this.chatInput.setAttribute("disabled","disabled"),this.sendButton.setAttribute("disabled","disabled"),this.renderMessage("object"===(0,a.A)(t)?t.text:t,!0,null),this.chatInput.value="";var n=function(){e.chatInput.hasAttribute("disabled")?setTimeout(n,100):e.chatInput.focus()};setTimeout(n,500),this.sendMessage("object"===(0,a.A)(t)?t.value:t)}}},{key:"renderLoadingImage",value:function(){this.chatInput&&(this.chatInput.disabled=!0,this.sendButton.disabled=!0);var e=document.createElement("template");e.innerHTML='<div class="bubble-container loading-message">\n      <div class="bubble" style="background: #FFF; border: none">\n        <div><img style="width:65px" src="'.concat(this.options.baseUrl,'/images/apply-loading-grey.gif"></div>\n      </div>\n    </div>');var t=this.shadowRoot.querySelector(".chat-messages .content");t&&t.appendChild(e.content.cloneNode(!0))}},{key:"isFormContextMessage",value:function(e){try{var t=e;if("string"==typeof e){var n=e;if(e.includes("<p>")&&e.includes("</p>")&&e.includes("formName")){if(e.startsWith("<p>")&&e.endsWith("</p>"))n=e.slice(3,-4);else if(e.includes("formName")&&e.startsWith("{"))n=e;else{var s=e.indexOf("<p>"),i=e.lastIndexOf("</p>");-1!==s&&-1!==i&&i>s&&(n=e.slice(s+3,i))}n=n.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}try{t=JSON.parse(n)}catch(e){return!1}}return t&&"object"===(0,a.A)(t)&&t.formName&&t.messages&&t.formContextKey&&Array.isArray(t.messages)}catch(e){return!1}}},{key:"handleFormContext",value:function(e){var t=this;try{var n=e;if("string"==typeof e){var s=e;if(e.includes("<p>")&&e.includes("</p>")&&e.includes("formName")){if(e.startsWith("<p>")&&e.endsWith("</p>"))s=e.slice(3,-4);else{var a=e.indexOf("<p>"),i=e.lastIndexOf("</p>");-1!==a&&-1!==i&&i>a&&(s=e.slice(a+3,i))}s=s.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}try{n=JSON.parse(s)}catch(e){return}}var o="form_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r='\n        <div class="form-context-container" data-form-id="'.concat(o,'">\n          <div class="form-header">\n            <h3 class="form-title">').concat(n.formName,'</h3>\n            <div class="form-subtitle">Please read the information below, then answer the questions that follow.</div>\n          </div>\n          <div class="form-messages">\n            <div class="form-messages-content" data-form-id="').concat(o,'">\n              ').concat(n.messages.map(function(e){return'<div class="form-message-content">'.concat(e.replace(/\\"/g,'"').trim(),"</div>")}).join(""),'\n            </div>\n            <div class="form-messages-toggle">\n              <button class="read-more-btn" data-form-id="').concat(o,'" data-form-key="').concat(n.formContextKey,'">\n                <span class="read-more-text">Read More</span>\n                <svg class="read-more-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none">\n                  <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n                </svg>\n              </button>\n            </div>\n          </div>\n          <div class="form-ready-indicator">\n            <button class="continue-btn" data-form-id="').concat(o,'" data-form-key="').concat(n.formContextKey,'">\n              <span>Continue to Questions</span>\n              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">\n                <path d="M8 1L15 8L8 15M15 8H1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n              </svg>\n            </button>\n          </div>\n        </div>\n      ');this.renderRegularMessage(r,!1),this.disableChatInput(),setTimeout(function(){var e=t.shadowRoot.querySelector('[data-form-id="'.concat(o,'"].read-more-btn')),n=t.shadowRoot.querySelector('[data-form-id="'.concat(o,'"].continue-btn'));e&&e.addEventListener("click",t.handleReadMoreClick.bind(t)),n&&n.addEventListener("click",function(){t.handleFormContextContinue(n)})},100)}catch(t){this.renderRegularMessage(e,!1)}}},{key:"handleReadMoreClick",value:function(e){var t=e.target.closest(".read-more-btn"),n=t.closest(".form-messages").querySelector(".form-messages-content"),s=t.querySelector(".read-more-text"),a=t.querySelector(".read-more-arrow");n.classList.contains("expanded")?(n.classList.remove("expanded"),s.textContent="Read More",a.style.transform="rotate(0deg)"):(n.classList.add("expanded"),s.textContent="Read Less",a.style.transform="rotate(180deg)")}},{key:"handleFormContextContinue",value:function(e){if(e){e.style.display="none";var t=e.closest(".form-ready-indicator");t&&(t.style.display="none")}this.updateMessageFormAndSendMessage("continue")}},{key:"renderRegularMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=document.createElement("template");e&&(e=e.replace(/((http|https|ftp):\/\/[\w?=&.-;#~%-]+(?![\w\s?&.;#~%"=-]*>))/g,'<a href="$1" target="_blank">Click Here</a>')),n.innerHTML='<div class="bubble-container '.concat(t?"from-user":"",'">\n      <div class="bubble">\n        <div>').concat(e,"</div>\n      </div>\n    </div>");var s=this.shadowRoot.querySelector(".chat-messages .content");s&&s.appendChild(n.content.cloneNode(!0))}},{key:"renderMessage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;if(!this.options.blackListMessagesContains.some(function(t){return e&&e.includes(t)})){if(!n){var a=this.shadowRoot.querySelector(".loading-message");a&&a.remove()}if(this.isFormContextMessage(e))this.handleFormContext(e);else{var i=document.createElement("template");e=e.replace(/((http|https|ftp):\/\/[\w?=&.-;#~%-]+(?![\w\s?&.;#~%"=-]*>))/g,'<a href="$1" target="_blank">click here</a>'),/<form[\s>]/i.test(e)||(e=e.replaceAll("\n"," <br>")),i.innerHTML='<div class="bubble-container '.concat(n?"from-user":"",'">\n      <div class="bubble">\n        <div>').concat(e,"</div>\n      </div>\n    </div>");var o=this.shadowRoot.querySelector(".chat-messages .content");o&&(o.appendChild(i.content.cloneNode(!0)),setTimeout(function(){var e,n=null===(e=t.shadowRoot.querySelector(".chat-messages .content"))||void 0===e?void 0:e.scrollHeight;n&&o.scrollTo(0,n)},100)),this.handleCustomForm(e),this.handleSubmissionComplete(s,e)}}}},{key:"initializeFormContextInteractions",value:function(){var e=this;this.shadowRoot.querySelectorAll(".read-more-btn:not([data-initialized])").forEach(function(t){t.setAttribute("data-initialized","true"),t.addEventListener("click",function(n){n.preventDefault();var s=t.getAttribute("data-form-key");s&&e.toggleFormMessages(s)})}),this.shadowRoot.querySelectorAll(".continue-btn:not([data-initialized])").forEach(function(t){t.setAttribute("data-initialized","true"),t.addEventListener("click",function(t){t.preventDefault(),e.proceedWithQuestions()})})}},{key:"toggleFormMessages",value:function(e){var t=this,n=this.shadowRoot.getElementById("form-messages-"+e);if(n){var s=n.querySelector(".form-messages-content"),a=n.querySelector(".read-more-btn"),i=a.querySelector(".read-more-text"),o=a.querySelector(".read-more-arrow");s.classList.contains("expanded")?(s.classList.remove("expanded"),i.textContent="Read More",o.style.transform="rotate(0deg)"):(s.classList.add("expanded"),i.textContent="Show Less",o.style.transform="rotate(180deg)"),setTimeout(function(){var e=t.shadowRoot.querySelector(".chat-messages");e&&e.scrollTo(0,e.scrollHeight)},300)}}},{key:"proceedWithQuestions",value:function(){this.chatInput&&this.sendButton&&(this.chatInput.value="continue",this.sendButton.click())}},{key:"handleFormContextScroll",value:function(e){var t=this;e&&"string"==typeof e&&e.includes("form-context-container")&&setTimeout(function(){var e=t.shadowRoot.querySelectorAll(".form-context-container");if(e.length>0){var n=e[e.length-1];if(t.shadowRoot.querySelector(".chat-messages")&&n){var s=n.querySelector(".form-header")||n;s.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),s.style.transition="background-color 0.3s ease",s.style.backgroundColor="rgba(59, 130, 246, 0.1)",setTimeout(function(){s.style.backgroundColor=""},1500)}}},300)}},{key:"validateFileExtension",value:function(e){return!!/(\.pdf|\.docx|\.doc)$/i.test(e.value)||(alert("Invalid file type."),e.form.reset(),e.focus(),!1)}},{key:"handleCustomForm",value:function(e){var t=this;e.includes("<form>")?(this.chatInput.setAttribute("disabled","disabled"),this.chatInput.classList.add("button-disabled"),this.sendButton.setAttribute("disabled","disabled"),this.sendButton.classList.add("button-disabled")):(this.chatInput.removeAttribute("disabled"),this.chatInput.classList.remove("button-disabled"),this.sendButton.removeAttribute("disabled"),this.sendButton.classList.remove("button-disabled"),this.enableChatInput()),this.initializeSearchableSelects();var n=this.shadowRoot.querySelectorAll(".chat-messages form");n.length&&n[n.length-1].addEventListener("submit",function(e){if(e.preventDefault(),t.customFormValue=null,(0,i.A)(e.target.children).some(function(e){return"file"===e.type})){var n=e.target.querySelector('input[type="file"]');if(!t.validateFileExtension(n))return;t.customFormValue=n.files[0],t.customFormValue&&t.sendFile(t.customFormValue)}else if((0,i.A)(e.target.children).some(function(e){return"date"===e.type})){var s=e.target.querySelector('input[type="date"]');s.value&&t.updateMessageFormAndSendMessage(s.value)}else if(e.target.querySelector('input[data-searchable-select="true"]')){var a=e.target.querySelector('input[data-searchable-select="true"]'),o=e.target.querySelector('input[name="answer"]');if(!o||!o.value)return void t.renderMessage("Please select an option from the list",!1,null);t.renderMessage(a.value,!0,null),t.sendMessage(o.value)}else{var r=(0,i.A)(e.target.querySelectorAll('input[name="answer"]:checked'));if(!r.length)return;t.updateMessageFormAndSendMessage({text:r.map(function(e){return e.nextElementSibling.innerText}).join(", "),value:r.map(function(e){return e.value}).join(",")})}t.customFormValue&&(e.target.querySelector("button")&&e.target.querySelector("button").remove(),e.target.querySelectorAll("input").forEach(function(e){e.setAttribute("disabled","disabled")}))}),n.length>1&&n.forEach(function(e,t){t!==n.length-1&&(e.querySelector("button")&&e.querySelector("button").remove(),e.querySelectorAll("input").forEach(function(e){e.remove()}),e.querySelectorAll(".radio-toggle-buttons-container").forEach(function(e){e.remove()}))}),this.shadowRoot.querySelectorAll(".question-skip-btn").forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();var s=t.shadowRoot.querySelectorAll(".question-skip-btn"),a=t.shadowRoot.querySelectorAll("*"),i=Array.from(a).filter(function(e){return e.textContent&&"skip"===e.textContent.trim().toLowerCase()&&"SCRIPT"!==e.tagName&&"STYLE"!==e.tagName});t.updateMessageFormAndSendMessage("skip"),e.textContent="Skipped",e.disabled=!0,e.style.color="#adb5bd",e.style.cursor="not-allowed",e.style.opacity="0.6";var o=e.closest("form");o&&o.querySelectorAll("input, button").forEach(function(e){e.setAttribute("disabled","disabled")}),s.forEach(function(t){t!==e&&(t.textContent="Skipped",t.disabled=!0,t.style.color="#adb5bd",t.style.cursor="not-allowed",t.style.opacity="0.6")}),i.forEach(function(t){t!==e&&(t.textContent="Skipped","BUTTON"!==t.tagName&&"A"!==t.tagName||(t.disabled=!0,t.style.color="#adb5bd",t.style.cursor="not-allowed",t.style.opacity="0.6"))})})}),n.forEach(function(e){e.addEventListener("change",function(){var t=e.querySelector(".eapply-btn");t.removeAttribute("disabled"),t.classList.remove("button-disabled")})})}},{key:"isUserApplied",value:function(e){return["submit_success","already_applied","questions_complete","submitted","failed"].includes(e)}},{key:"handleSubmissionComplete",value:function(e,t){var n=this;e&&!["new","invited","started","questions_started","confirm_stop","declined","invalid_answers_limit_exceeded"].includes(e)&&(this.isUserApplied(e)?(this.applyWebContainer.querySelector(".completed").classList.add("complete"),this.applyWebContainer.querySelector(".apply-now").classList.add("applied"),document.querySelectorAll(".apply-btn").forEach(function(e){e.classList.add("applied"),e.innerText="Applied"}),this.applyWebContainer.querySelector(".apply-now").innerText="Applied",this.applyWebContainer.querySelector(".completed .eapply-btn").addEventListener("click",function(){n.dispatchEvent(new Event("submitted",{bubbles:!1}))}),t&&(this.applyWebContainer.querySelector("#complete-message").innerHTML=t)):this.applyWebContainer.remove(),console.log("appUserStatus",e))}},{key:"sendFile",value:function(e){var t=this,n=new FormData;n.append("answer",e),n.append("daliaApplyToken",this.getUserToken()),window.fetch("".concat(this.options.baseUrl,"/").concat(this.options.submitPath),{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){t.renderMessage(e.message,!1,e.appUserStatus),t.chatInput&&(t.chatInput.disabled=!1,t.sendButton.disabled=!1)})}},{key:"initializeSearchableSelects",value:function(){var e=this,t=this.shadowRoot.querySelectorAll('input[data-searchable-select="true"]');t.length>0&&this.disableChatInput(),t.forEach(function(t){if(!t.hasAttribute("data-initialized")){var n=t.closest(".searchable-select-container"),s=n.querySelector(".searchable-select-dropdown"),a=s.querySelector(".searchable-select-options"),i=n.querySelector('input[name="answer"]'),o=n.parentElement.querySelector("button.eapply-btn"),r=[];try{var c=t.getAttribute("data-options");r=JSON.parse(c.replace(/&quot;/g,'"'))}catch(e){return void console.error("Failed to parse searchable select options:",e)}t.setAttribute("data-initialized","true"),t.removeAttribute("readonly"),t.addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation(),t.style.transform="translateY(-1px)"}),t.addEventListener("blur",function(){setTimeout(function(){t.style.transform="translateY(0)"},200)}),t.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation(),e.disableChatInput(),e.showDropdown(s,a,r,t,i,o)}),t.addEventListener("input",function(n){if(!t.hasAttribute("data-selecting")){var c=n.target.value.toLowerCase();e.filterOptions(a,r,c,t,i,o),e.showDropdown(s,a,r,t,i,o)}});var l=function(t){n.contains(t.target)||s.contains(t.target)||s.classList.contains("show")&&e.hideDropdown(s)};document.addEventListener("click",l,!0),s.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault()}),e.addEventListener("remove",function(){document.removeEventListener("click",l,!0)})}})}},{key:"showDropdown",value:function(e,t,n,s,a,i){if(0!==n.length){var o=s.value.toLowerCase();this.filterOptions(t,n,o,s,a,i);var r=s.getBoundingClientRect(),c=Math.min(300,52*n.length),l=window.innerHeight-r.bottom,d=r.top,u=s.closest(".eapply-popup"),p=u?u.getBoundingClientRect():null,h=l<c&&d>l;if(p){var v=r.top-p.top,y=p.bottom-r.bottom;h&&v<c&&(h=!1),!h&&y<c&&(h=!0)}h?(e.style.top="auto",e.style.bottom="calc(100% + 2px)",e.style.borderRadius="8px 8px 0 0",e.style.transformOrigin="bottom center"):(e.style.top="calc(100% + 2px)",e.style.bottom="auto",e.style.borderRadius="8px",e.style.transformOrigin="top center"),e.classList.add("show"),e.style.setProperty("display","block","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("transform","translateY(0)","important"),e.style.setProperty("pointer-events","auto","important"),this.disableChatInput(),e.offsetHeight}}},{key:"hideDropdown",value:function(e){e.classList.remove("show"),e.style.setProperty("opacity","0","important"),e.style.setProperty("transform","translateY(-10px)","important"),e.style.setProperty("pointer-events","none","important"),e.style.setProperty("display","none","important"),e.style.setProperty("visibility","hidden","important")}},{key:"disableChatInput",value:function(){this.options.autoHideChatInput&&this.chatInputContainer&&this.chatInputContainer.classList.add("hide"),this.chatInput&&(this.chatInput.disabled=!0,this.chatInput.placeholder="Complete your selection first...",this.chatInput.style.opacity="0.5",this.chatInput.style.cursor="not-allowed",this.chatInput.setAttribute("disabled","disabled"),this.sendButton&&(this.sendButton.disabled=!0,this.sendButton.style.opacity="0.5",this.sendButton.style.cursor="not-allowed"))}},{key:"enableChatInput",value:function(){this.chatInputContainer&&this.chatInputContainer.classList.remove("hide"),this.chatInput&&(this.chatInput.disabled=!1,this.chatInput.placeholder="Type your message...",this.chatInput.style.opacity="1",this.chatInput.style.cursor="text",this.sendButton&&(this.sendButton.disabled=!1,this.sendButton.style.opacity="1",this.sendButton.style.cursor="pointer"))}},{key:"filterOptions",value:function(e,t,n,a,i,o){var r=this;e.innerHTML="";var c=this.enhancedSearch(t,n),l=c.slice(0,50);if(!n){var d=document.createElement("div");d.className="searchable-search-header",d.innerHTML='\n        <div class="search-results-info">\n          <span class="results-count">'.concat(l.length," option").concat(1!==l.length?"s":"",' available</span>\n          <span class="search-term">Type to search</span>\n        </div>\n      '),e.appendChild(d);var u=a.getAttribute("data-question-context")||"",p=this.groupOptionsByType(l,u);Object.entries(p).forEach(function(t){var n=(0,s.A)(t,2),c=n[0],l=n[1];if(l.length>0){var d=document.createElement("div");d.className="searchable-group-header",d.textContent=c,e.appendChild(d)}l.forEach(function(t,n){var s=document.createElement("div");s.className="searchable-option",s.dataset.value=t.value,s.dataset.index=n;var c=r.createEnhancedOptionDisplay(t,"",u);s.innerHTML=c,s.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r.selectOption(t,a,i,o)}),s.addEventListener("mouseenter",function(){e.querySelectorAll(".searchable-option").forEach(function(e){e.classList.remove("selected")}),s.classList.add("selected")}),e.appendChild(s)})});var h=document.createElement("div");return h.className="searchable-keyboard-hint",h.innerHTML='\n        <div class="keyboard-shortcuts">\n          <span class="shortcut"><kbd>Enter</kbd> Select</span>\n          <span class="shortcut"><kbd>Esc</kbd> Close</span>\n        </div>\n      ',void e.appendChild(h)}if(n&&c.length>0){var v=document.createElement("div");v.className="searchable-search-header",v.innerHTML='\n        <div class="search-results-info">\n          <span class="results-count">'.concat(c.length," result").concat(1!==c.length?"s":"",' found</span>\n          <span class="search-term">for "').concat(n,'"</span>\n        </div>\n      '),e.appendChild(v)}var y=a.getAttribute("data-question-context")||"",f=this.groupOptionsByType(l,y);if(Object.entries(f).forEach(function(t){var c=(0,s.A)(t,2),l=c[0],d=c[1];if(d.length>0){var u=document.createElement("div");u.className="searchable-group-header",u.textContent=l,e.appendChild(u)}d.forEach(function(t,s){var c=document.createElement("div");c.className="searchable-option",c.dataset.value=t.value,c.dataset.index=s;var l=r.createEnhancedOptionDisplay(t,n,y);c.innerHTML=l,c.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r.selectOption(t,a,i,o)}),c.addEventListener("mouseenter",function(){e.querySelectorAll(".searchable-option").forEach(function(e){e.classList.remove("selected")}),c.classList.add("selected")}),e.appendChild(c)})}),0===c.length){var m=document.createElement("div");m.className="searchable-no-results",m.innerHTML='\n        <div class="no-results-icon">🔍</div>\n        <div class="no-results-text">\n          <div class="no-results-title">No options found matching "'.concat(n,'"</div>\n          <div class="no-results-suggestions">\n            <div class="suggestion-title">Try these suggestions:</div>\n            <ul class="suggestion-list">\n              <li>Check your spelling</li>\n              <li>Try a shorter search term</li>\n              <li>Use partial names (e.g., "Alabama" instead of "Alabama A&M")</li>\n              <li>Select "Other" if your school isn\'t listed</li>\n            </ul>\n          </div>\n        </div>\n      '),e.appendChild(m)}if(c.length>50){var b=document.createElement("div");b.className="searchable-more-info",b.innerHTML='\n        <div class="more-results-info">\n          <span class="showing-text">Showing first 50 of '.concat(c.length,' results</span>\n          <span class="narrow-text">Type more to narrow your search</span>\n        </div>\n      '),e.appendChild(b)}if(1===c.length&&c[0].text.toLowerCase()===n.toLowerCase()){var g=e.querySelector(".searchable-option");g&&g.classList.add("selected")}if(c.length>0){var w=document.createElement("div");w.className="searchable-keyboard-hint",w.innerHTML='\n        <div class="keyboard-shortcuts">\n          <span class="shortcut"><kbd>Enter</kbd> Select</span>\n          <span class="shortcut"><kbd>Esc</kbd> Close</span>\n        </div>\n      ',e.appendChild(w)}}},{key:"enhancedSearch",value:function(e,t){var n=this;if(!t)return e.slice(0,50);var s=t.toLowerCase().trim(),a=[];return e.forEach(function(e){var t=e.text.toLowerCase(),i=e.value.toLowerCase();t===s||i===s?a.unshift(b(b({},e),{},{score:100,matchType:"exact"})):t.startsWith(s)||i.startsWith(s)?a.push(b(b({},e),{},{score:90,matchType:"starts-with"})):t.includes(s)||i.includes(s)?a.push(b(b({},e),{},{score:80,matchType:"contains"})):n.hasWordBoundaryMatch(t,s)&&a.push(b(b({},e),{},{score:70,matchType:"word-boundary"}))}),a.sort(function(e,t){return t.score-e.score}),a}},{key:"hasWordBoundaryMatch",value:function(e,t){return e.split(/\s+/).some(function(e){return e.startsWith(t)})}},{key:"groupOptionsByType",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").toLowerCase();return t.includes("school")||t.includes("university")||t.includes("college")||t.includes("education")?this.groupBySchoolType(e):t.includes("major")||t.includes("degree")||t.includes("field of study")?this.groupByDegreeType(e):t.includes("job title")||t.includes("position")||t.includes("role")?this.groupByJobCategory(e):{Options:e}}},{key:"groupBySchoolType",value:function(e){var t={Universities:[],Colleges:[],"High Schools":[],"Technical Schools":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("university")?t.Universities.push(e):n.includes("college")?t.Colleges.push(e):n.includes("high school")||n.includes("high")?t["High Schools"].push(e):n.includes("technical")||n.includes("tech")||n.includes("institute")?t["Technical Schools"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"groupByDegreeType",value:function(e){var t={"Bachelor's Degrees":[],"Master's Degrees":[],"Associate's Degrees":[],"Certificates & Diplomas":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("bachelor")||n.includes("ba ")||n.includes("bs ")||n.includes("b.s.")||n.includes("b.a.")?t["Bachelor's Degrees"].push(e):n.includes("master")||n.includes("ma ")||n.includes("ms ")||n.includes("m.s.")||n.includes("m.a.")?t["Master's Degrees"].push(e):n.includes("associate")||n.includes("aa ")||n.includes("as ")||n.includes("a.s.")||n.includes("a.a.")?t["Associate's Degrees"].push(e):n.includes("certificate")||n.includes("diploma")||n.includes("certification")?t["Certificates & Diplomas"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"groupByJobCategory",value:function(e){var t={Management:[],Technical:[],Administrative:[],"Sales & Marketing":[],Other:[]};return e.forEach(function(e){var n=e.text.toLowerCase();n.includes("manager")||n.includes("director")||n.includes("supervisor")||n.includes("lead")||n.includes("chief")?t.Management.push(e):n.includes("engineer")||n.includes("developer")||n.includes("analyst")||n.includes("specialist")||n.includes("technician")?t.Technical.push(e):n.includes("assistant")||n.includes("coordinator")||n.includes("administrator")||n.includes("clerk")?t.Administrative.push(e):n.includes("sales")||n.includes("marketing")||n.includes("representative")||n.includes("account")?t["Sales & Marketing"].push(e):t.Other.push(e)}),Object.keys(t).forEach(function(e){0===t[e].length&&delete t[e]}),t}},{key:"createEnhancedOptionDisplay",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=e.text;if(t){var a=new RegExp("(".concat(t,")"),"gi");s=e.text.replace(a,'<strong class="highlight">$1</strong>')}var i="",o=n.toLowerCase();return i=o.includes("school")||o.includes("university")||o.includes("college")||o.includes("education")?e.text.toLowerCase().includes("university")?'<span class="type-indicator university">🏛️</span>':e.text.toLowerCase().includes("college")?'<span class="type-indicator college">🎓</span>':e.text.toLowerCase().includes("high school")?'<span class="type-indicator high-school">🏫</span>':e.text.toLowerCase().includes("technical")?'<span class="type-indicator technical">⚙️</span>':'<span class="type-indicator other">🔍</span>':o.includes("major")||o.includes("degree")||o.includes("field of study")?e.text.toLowerCase().includes("bachelor")||e.text.toLowerCase().includes("master")||e.text.toLowerCase().includes("associate")?'<span class="type-indicator degree">🎓</span>':e.text.toLowerCase().includes("certificate")?'<span class="type-indicator certificate">📜</span>':'<span class="type-indicator other">📚</span>':o.includes("job title")||o.includes("position")||o.includes("role")?e.text.toLowerCase().includes("manager")||e.text.toLowerCase().includes("director")?'<span class="type-indicator management">👔</span>':e.text.toLowerCase().includes("engineer")||e.text.toLowerCase().includes("developer")?'<span class="type-indicator technical">💻</span>':e.text.toLowerCase().includes("assistant")||e.text.toLowerCase().includes("coordinator")?'<span class="type-indicator admin">📋</span>':'<span class="type-indicator job">💼</span>':o.includes("location")||o.includes("city")||o.includes("state")?'<span class="type-indicator location">📍</span>':'<span class="type-indicator default">📝</span>','\n      <div class="option-content">\n        <div class="option-main">\n          '.concat(i,'\n          <span class="option-text">').concat(s,"</span>\n        </div>\n      </div>\n    ")}},{key:"selectOption",value:function(e,t,n,s){t.setAttribute("data-selecting","true"),t.value=e.text,n.value=e.value,t.style.borderColor="#48bb78",t.style.boxShadow="0 0 0 4px rgba(72, 187, 120, 0.1)",s&&(s.classList.remove("button-disabled"),s.style.animation="buttonPulse 0.6s ease-out");var a=t.closest(".searchable-select-container").querySelector(".searchable-select-dropdown");a&&(a.classList.remove("show"),a.style.setProperty("display","none","important"),a.style.setProperty("visibility","hidden","important"),a.style.setProperty("opacity","0","important"),a.style.setProperty("pointer-events","none","important"),a.style.setProperty("transform","translateY(-10px)","important")),setTimeout(function(){t.removeAttribute("data-selecting")},100),setTimeout(function(){t.style.borderColor="",t.style.boxShadow=""},2e3),t.focus()}},{key:"renderSimpleFormReview",value:function(e){var t=this;this.currentFormsData=e;var n='<div class="form-review-container"><h2>Review Your Application</h2>';e.forEach(function(e,s){n+='<div class="form-section">\n        <h3>'.concat(e.formName,"</h3>");var a=[],i=!1;e.items.forEach(function(e,s){"MESSAGE"===e.type?(a.length>0&&(n+=t.renderMessageGroup(a),a=[]),n+='<div class="message-group">\n            <div class="form-message">'.concat(e.content,"</div>"),i=!0):"QUESTION"===e.type&&(a.push(e),i=!0)}),a.length>0&&(n+=t.renderMessageGroup(a)),e.items.some(function(e){return"MESSAGE"===e.type})&&(n+="</div>"),i||(n+='<div class="no-items">No items in this form.</div>'),n+="</div>"}),n+='\n      <div class="review-actions">\n        <button class="submit-application-btn">Submit Application</button>\n      </div>\n    </div>',this.renderMessage(n,!1);var s=this.shadowRoot.querySelector(".submit-application-btn");s&&s.addEventListener("click",function(){t.submitApplicationWithEdits()}),this.attachEditButtonListeners(e)}},{key:"startEditingAnswer",value:function(e,t){var n=this,s=this.getQuestionData(e,t);if(s){var a=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(a){var i=a.querySelector(".answer-container");if(i){var o=this.getQuestionOptions(s),r="";if(o&&o.length>0){var c=s.required||!1;r='\n                  <div class="edit-answer-container">\n                    <select class="edit-answer-select" data-question-id="'.concat(e,'">\n                      <option value="">Select an answer...</option>\n                      ').concat(c?"":'<option value="skip">Skip this question</option>',"\n                      ").concat(o.map(function(e){var t=s.answer===e.label||s.answer===e.value;return'<option value="'.concat(e.value,'" ').concat(t?"selected":"",">").concat(e.label,"</option>")}).join(""),'\n                    </select>\n                    <div class="edit-actions">\n                      <button class="save-answer-btn" data-question-id="').concat(e,'">Save</button>\n                      <button class="cancel-edit-btn" data-question-id="').concat(e,'">Cancel</button>\n                    </div>\n                  </div>\n                ')}else{var l=s.required||!1;r='\n                  <div class="edit-answer-container">\n                    <textarea class="edit-answer-textarea" data-question-id="'.concat(e,'" placeholder="Enter your answer...">').concat("Skipped"===s.answer||"No answer provided"===s.answer?"":s.answer,'</textarea>\n                    <div class="edit-actions">\n                      <button class="save-answer-btn" data-question-id="').concat(e,'">Save</button>\n                      <button class="cancel-edit-btn" data-question-id="').concat(e,'">Cancel</button>\n                      ').concat(l?"":'<button class="skip-answer-btn" data-question-id="'.concat(e,'">Skip</button>'),"\n                    </div>\n                  </div>\n                ")}i.innerHTML=r;var d=i.querySelector(".save-answer-btn"),u=i.querySelector(".cancel-edit-btn"),p=i.querySelector(".skip-answer-btn");d&&d.addEventListener("click",function(s){n.saveEditedAnswer(e,t)}),u&&u.addEventListener("click",function(s){n.cancelEditAnswer(e,t)}),p&&p.addEventListener("click",function(s){n.skipEditedAnswer(e,t)})}else console.error("Answer container not found")}else console.error("Question element not found for ID:",e)}else console.error("Question data not found for ID:",e)}},{key:"getQuestionData",value:function(e,t){var n,s=y(t);try{for(s.s();!(n=s.n()).done;){var a,i=y(n.value.items);try{for(i.s();!(a=i.n()).done;){var o=a.value;if("QUESTION"===o.type&&o.id==e)return o}}catch(e){i.e(e)}finally{i.f()}}}catch(e){s.e(e)}finally{s.f()}return null}},{key:"getQuestionOptions",value:function(e){return e.questionOptions&&e.questionOptions.length>0?e.questionOptions.filter(function(e){return"Select"!==e.value&&"Select"!==e.label&&"-1"!==e.value&&"-1"!==e.label}).map(function(e){return{value:e.value||e.label,label:e.label||e.value}}):null}},{key:"saveEditedAnswer",value:function(e,t){var n=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(n){var s=n.querySelector(".edit-answer-container");if(s){var a="",i=s.querySelector(".edit-answer-select"),o=s.querySelector(".edit-answer-textarea");if(i?a=i.value:o&&(a=o.value.trim()),a){var r,c=y(t);try{for(c.s();!(r=c.n()).done;){var l,d=y(r.value.items);try{for(d.s();!(l=d.n()).done;){var u=l.value;if("QUESTION"===u.type&&u.id==e){u.answer="skip"===a?"Skipped":a,u.isSkipped="skip"===a;break}}}catch(e){d.e(e)}finally{d.f()}}}catch(e){c.e(e)}finally{c.f()}this.storeEditedAnswer(e,a),this.renderAnswerDisplay(n,"skip"===a?"Skipped":a,"skip"===a)}else alert('Please provide an answer or select "Skip this question"')}}}},{key:"skipEditedAnswer",value:function(e,t){this.saveEditedAnswer(e,t,"skip")}},{key:"cancelEditAnswer",value:function(e,t){var n=this.shadowRoot.querySelector('[data-question-id="'.concat(e,'"]'));if(n){var s,a="",i=y(t);try{for(i.s();!(s=i.n()).done;){var o,r=y(s.value.items);try{for(r.s();!(o=r.n()).done;){var c=o.value;if("QUESTION"===c.type&&c.id==e){a=c.answer;break}}}catch(e){r.e(e)}finally{r.f()}}}catch(e){i.e(e)}finally{i.f()}this.renderAnswerDisplay(n,a,"Skipped"===a)}}},{key:"renderAnswerDisplay",value:function(e,t,n){var s=this,a=e.querySelector(".answer-container");if(a){var i=n?"answer-text skipped":"answer-text";a.innerHTML='\n                <div class="'.concat(i,'">').concat(t,'</div>\n                <button class="edit-answer-btn" data-question-id="').concat(e.getAttribute("data-question-id"),'">Edit</button>\n              ');var o=a.querySelector(".edit-answer-btn");o&&o.addEventListener("click",function(e){var t=e.target.getAttribute("data-question-id");s.startEditingAnswer(t,s.currentFormsData)})}}},{key:"storeEditedAnswer",value:function(e,t){this.editedAnswers||(this.editedAnswers={}),this.editedAnswers[e]=t}},{key:"submitApplicationWithEdits",value:function(){var e=[{review_confirmed:!0,editedAnswers:this.editedAnswers||{}}];this.sendMessage(JSON.stringify(e))}},{key:"attachEditButtonListeners",value:function(e){var t=this;this.shadowRoot.querySelectorAll(".edit-answer-btn").forEach(function(n){n.addEventListener("click",function(n){var s=n.target.getAttribute("data-question-id");t.startEditingAnswer(s,e)})})}},{key:"renderMessageGroup",value:function(e){if(0===e.length)return"";var t='<div class="questions-section">\n                <div class="questions-header">Questions:</div>';return e.forEach(function(e,n){var s=e.isSkipped?"question-item skipped":"question-item",a=e.isSkipped?"answer-text skipped":"answer-text";t+='<div class="'.concat(s,'" data-question-id="').concat(e.id,'">\n                  <div class="question-text">').concat(n+1,". ").concat(e.question,'</div>\n                  <div class="answer-container">\n                    <div class="').concat(a,'">').concat(e.answer,'</div>\n                    <button class="edit-answer-btn" data-question-id="').concat(e.id,'">Edit</button>\n                  </div>\n                </div>')}),t+="</div>"}}]);var r,h}(window.HTMLElement);window.customElements.get("dalia-apply-web")||window.customElements.define("dalia-apply-web",A)}}]);